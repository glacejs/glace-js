<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"globals.js.html":{"id":"globals.js.html","title":"Source: globals.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: globals.js &quot;use strict&quot;; /** * Contains global framework functions and helpers. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var findProcess = require(&quot;find-process&quot;); var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; require(&quot;./fixtures&quot;); require(&quot;./matcher&quot;); var CONF = require(&quot;./config&quot;); var hacking = require(&quot;./hacking&quot;); var TestCase = require(&quot;./testing&quot;).TestCase; /** * Helper to set actual log file. * * @function */ var setLog = () =&gt; { var testName = CONF.curTestCase ? _.kebabCase(CONF.curTestCase.name) : &quot;&quot;; var logFile = path.resolve(CONF.reportsDir, testName, &quot;logs&quot;, &quot;test.log&quot;); LOG.setFile(logFile); }; setLog(); // Set log immediatelly. /** * `chaijs` `expect` function. * * @global * @function * @arg {*} actualValue - Some actual value which should be checked. * @see {@link http://chaijs.com/|chaijs} to get more details about * `expect` usage. * @example expect(1).to.be.equal(1); expect(2).to.be.gte(0); */ global.expect = require(&quot;chai&quot;).expect; /** * `GlaceJS` config. * * @global * @see {@link module:config|config} to get more details about its options. */ global.CONF = CONF; /** * Atomic steps collection. * * @global * @see {@link module:steps/index|steps} to get more details about its methods. */ global.SS = new (require(&quot;./steps&quot;)); /** * Execute tests scope. * * @global * @function * @arg {string} name - Scope name. * @arg {function[]} [fixtures] - List of fixtures. * @arg {function} func - Function with test cases. * @example scope(&quot;Some test scope&quot;, () =&gt; { test(&quot;Some test name&quot;, () =&gt; { before(() =&gt; { someFunc(); }); chunk(&quot;chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;chunk #2&quot;, () =&gt; { someFunc(); }); }); }); */ global.scope = (name, fixtures, func) =&gt; { if (fixtures instanceof Function) { func = fixtures; fixtures = []; }; describe(name, U.wrap(fixtures, func)); }; /** * Executed sessions counter. * * @type {Number} */ var sessNum = 0; /** * Executes tests session. * * @global * @function * @arg {string} [name] - Session name. By default it includes start date time. * @arg {object} [ctx] - Session context. By default it's empty. * @arg {function} func - Function with test cases. * @example session(() =&gt; { test(&quot;Test #1&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); test(&quot;Test #2&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); */ global.session = (name, ctx, func) =&gt; { if (!func &amp;&amp; !ctx) { func = name; ctx = {}; name = `Session ${new Date().toLocaleString()}`; } else if (!func) { func = ctx; ctx = name; name = `Session ${new Date().toLocaleString()}`; }; sessNum++; ctx.sessionNumber = sessNum; var fixtures = []; if (CONF.useXvfb) fixtures.push(fixXvfb); if (CONF.isWeb &amp;&amp; !CONF.webdriver.host) fixtures.push(fixSelenium); if (CONF.proxy.http) fixtures.push(fixHttpProxy); if (CONF.proxy.global) fixtures.push(fixGlobalProxy); if (CONF.isWeb) fixtures.push(fixWebdriver); if (CONF.isWeb) fixtures.push(fixBrowser); scope(name, () =&gt; { beforeSession(ctx); U.wrap(fixtures, func)(); afterSession(ctx); }); }; /** * Executes before tests session. May be overridden or expanded. * * @global * @function * @arg {object} ctx - Session context. * @example var oldBeforeSession = beforeSession; global.beforeSession = ctx =&gt; { before(() =&gt; { someFunc(); }); oldBeforeSession(ctx); }; */ global.beforeSession = ctx =&gt; { before(() =&gt; CONF.isRunPassed = true); if (CONF.isWeb) before(async () =&gt; await _killProcs(&quot;chromedriver&quot;)); }; /** * Executes after tests session. May be overridden or expanded. * * @global * @function * @arg {object} ctx - Session context. * @example var oldAfterSession = afterSession; global.afterSession = ctx =&gt; { oldAfterSession(ctx); after(() =&gt; { someFunc(); }); }; */ global.afterSession = ctx =&gt; {}; /** * Basis for any test case. * * If test with the same was registered already, this test will be omitted * with corresponding error in log. * * If retries amount is specified and this test was failed, the test will be * added to queue in separated session with title containing `Retry` and its * number. * * @abstract * @function * @arg {string} name - Name of test case. * @arg {object} [opts] - Options. * @arg {boolean} [opts.video=false] - Flag to involve video fixture. * @arg {boolean} [opts.skip=false] - Flag to skip test. * @arg {number} [opts.retry=0] - Number of retries on failure. May be managed * in config. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Test function. */ var baseTest = (names =&gt; { return (name, opts, fixtures, func) =&gt; { if (names.includes(name)) { LOG.warn(`Test case '${name}' is added already.`, `Test case with the same name will be omitted.`); return; }; if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; }; if (fixtures instanceof Function) { func = fixtures; fixtures = []; }; opts = opts || {}; fixtures = fixtures || []; opts.video = U.defVal(opts.video, CONF.captureVideo, false); opts.skip = U.defVal(opts.skip, false); opts.retry = U.defVal(opts.retry, CONF.testRetries, 0); if (opts.skip) { LOG.warn(`Test '${name}' is marked as skipped and will be omitted`); return; }; names.push(name); if (opts.video &amp;&amp; !fixtures.includes(fixVideo)) fixtures.push(fixVideo); var testCase = new TestCase(name); var retries = opts.retry; CONF.testCases.push(testCase); var testFunc = ctxs =&gt; { ctxs = ctxs || [{}]; scope(name, () =&gt; { before(() =&gt; { testCase.reset(); testCase.status = TestCase.IN_PROGRESS; CONF.curTestCase = testCase; setLog(); // Current test case is started, need to reinit log }); U.wrap(fixtures, () =&gt; { for (var ctx of ctxs) func(ctx); })(); after(() =&gt; { if (testCase.errors.length) { testCase.status = TestCase.FAILED; } else { testCase.status = TestCase.PASSED; }; CONF.curTestCase = null; setLog(); // Current test case is finished, need to reinit log if (testCase.status !== TestCase.FAILED || retries &lt;= 0) { return; }; retries--; var retryNum = CONF.testRetries - retries; var sessName = `Retry #${retryNum}`; /* Hack to pass mocha grep */ var mochaRunner = hacking.getRunner(); if (mochaRunner._grep !== mochaRunner._defaultGrep) { sessName += &quot; - &quot; + mochaRunner._grep.source; }; var ctx = { retryNumber: retryNum }; session(sessName, ctx, () =&gt; { testFunc(testCase.failedParams); }); }); }); }; testFunc(); }; })([]); /** * Executes test case. * * @global * @function * @arg {string} name - Name of test case. * @arg {object} [opts] - Options. * @arg {boolean} [opts.video=true] - Flag to involve video fixture. * @arg {boolean} [opts.skip=false] - Flag to skip test. * @arg {number} [opts.retry=0] - Number of retries on failure. May be managed * in config. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Test function. * @example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); */ global.test = (name, opts, fixtures, func) =&gt; { baseTest(name, opts, fixtures, ctx =&gt; { func(ctx); }); }; /** * Executes test chunk. * * Contains actions and verifications, which will be executed separatly * from another chunks. This function is used to organize test * structure and to allocate independent test actions. * * @global * @function * @arg {string} [name] - Name of test case. * @arg {function} func - Step function. * @example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); */ global.chunk = (name, func) =&gt; { if (name instanceof Function) { func = name; name = &quot;&quot;; }; it(name, func); }; /** * Executes before each test chunk. * * @global * @function * @arg {string} name - Name of test case. * @arg {function} func - Hook function. * @example test(&quot;Some test&quot;, () =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); */ global.beforeChunk = beforeEach; /** * Executes after each test chunk. * * @global * @function * @arg {string} name - Name of test case. * @arg {function} func - Hook function. * @example test(&quot;Some test&quot;, () =&gt; { afterChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); */ global.afterChunk = afterEach; /** * Iterates test chunks through all languages specifed in config. * * It's applicable for multilingual application. If list of languages is * specified, it will be used firstly. Otherwise from configuration. * * @global * @function * @arg {object} [ctx] - Test case context. * @arg {object} [opts] - Options. * @arg {boolean} [opts.video=false] - Flag to involve video fixture. May be * managed in config. * @arg {function[]} [fixtures] - Involved fixtures list. * @arg {function} func - Function with test steps. * @example test(&quot;Some test&quot;, ctx =&gt; { forEachLanguage(ctx, lang =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); */ global.forEachLanguage = (ctx, opts, fixtures, func) =&gt; { if (ctx instanceof Function) { func = ctx; ctx = {}; opts = {}; fixtures = []; }; if (opts instanceof Function) { func = opts; opts = {}; fixtures = []; }; if (fixtures instanceof Function) { func = fixtures; fixtures = []; }; ctx = ctx || {}; opts = opts || {}; fixtures = fixtures || []; opts.video = U.defVal(opts.video, CONF.captureVideo, false); if (opts.video &amp;&amp; !fixtures.includes(fixVideo)) fixtures.push(fixVideo); var languages = ctx.language ? [ctx.language] : CONF.languages; languages.forEach(lang =&gt; { scope(`for language &quot;${lang}&quot;`, () =&gt; { before(() =&gt; CONF.curTestCase.testParams.language = lang); U.wrap(fixtures, () =&gt; func(lang))(); }); }); }; /** * Helper to kill processes by name. * * @function * @async * @arg {string} procName - Process name or chunk of name. */ var _killProcs = (procName) =&gt; { return findProcess(&quot;name&quot;, procName).then(procList =&gt; { return procList.forEach(proc =&gt; { try { process.kill(proc.pid, &quot;SIGTERM&quot;); LOG.debug(`Kill ${procName} with PID ${proc.pid}`); } catch (e) { if (e.message !== &quot;kill ESRCH&quot;) throw e; LOG.error(`Can't kill ${procName} with PID ${proc.pid} ` + `because it doesn't exist`); }; }); }); }; × Search results Close "},"fixtures.js.html":{"id":"fixtures.js.html","title":"Source: fixtures.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: fixtures.js &quot;use strict&quot;; /** * `GlaceJS` fixtures. * * @module */ var CONF = require(&quot;./config&quot;); /** * Fixture to capture tests video. * * @global * @function */ global.fixVideo = func =&gt; { var isStarted; var errNumBefore; before(async () =&gt; { errNumBefore = CONF.curTestCase.errors.length; isStarted = await SS.startVideo(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.stopVideo(); isStarted = false; if (!CONF.forceVideo &amp;&amp; CONF.curTestCase.errors.length === errNumBefore) { SS.removeVideo(); }; }); }; /** * Fixture to launch xvfb. * * @global * @function */ global.fixXvfb = func =&gt; { var isStarted; before(async () =&gt; { isStarted = await SS.startXvfb(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.stopXvfb(); }); }; /** * Fixture to launch selenium server. * * @global * @function */ global.fixSelenium = func =&gt; { var isStarted; before(async () =&gt; { if (CONF.installDrivers) { CONF.installDrivers = false; await SS.installSeleniumDrivers(); }; isStarted = await SS.startSeleniumServer(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.stopSeleniumServer(); }); }; /** * Fixture to launch browser. * * @global * @function */ global.fixBrowser = func =&gt; { var isStarted; before(async () =&gt; { isStarted = await SS.launchBrowser(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.closeBrowser(); }); }; /** * Fixture to set webdriver. * * @global * @function */ global.fixWebdriver = func =&gt; { before(() =&gt; { var wdio = require(&quot;webdriverio&quot;); var webdriver = wdio.remote(CONF.webdriver); SS.setWebdriver(webdriver); }); func(); }; /** * Fixture to launch http proxy. * * @global * @function */ global.fixHttpProxy = func =&gt; { var isStarted; before(async () =&gt; { isStarted = await SS.startProxy(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.stopProxy(); }); }; /** * Fixture to launch http proxy. * * @global * @function */ global.fixGlobalProxy = func =&gt; { var isStarted; before(async () =&gt; { isStarted = await SS.startGlobalProxy(); }); func(); after(async () =&gt; { if (!isStarted) return; await SS.stopGlobalProxy(); }); }; × Search results Close "},"reporter_base.js.html":{"id":"reporter_base.js.html","title":"Source: reporter/base.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: reporter/base.js &quot;use strict&quot;; /** * `GlaceJS` common reporter. * * @class * @name GlaceReporter * @arg {object} runner - `MochaJS` runner. */ var _ = require(&quot;lodash&quot;); var util = require(&quot;util&quot;); var MochaReporter = require(&quot;mocha&quot;).reporters.base; var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; var CONF = require(&quot;../config&quot;); /** * Registered reporters. * * @type {object[]} */ var reporters = []; var GlaceReporter = function (runner) { MochaReporter.call(this, runner); runner.on(&quot;start&quot;, () =&gt; { for (var reporter of reporters) { if (reporter.start) reporter.start(); }; }); runner.on(&quot;end&quot;, () =&gt; { U.clearEmptyFolders(CONF.reportsDir) for (var reporter of reporters) { if (reporter.end) reporter.end(); }; }); runner.on(&quot;suite&quot;, mochaSuite =&gt; { var isTest = _isSuiteTest(mochaSuite); for (var reporter of reporters) { if (isTest) { if (reporter.test) reporter.test(mochaSuite); } else { if (reporter.scope) reporter.scope(mochaSuite); }; }; }); runner.on(&quot;suite end&quot;, mochaSuite =&gt; { var isTest = _isSuiteTest(mochaSuite); for (var reporter of reporters) { if (isTest) { if (reporter.testEnd) reporter.testEnd(mochaSuite); } else { if (reporter.scopeEnd) reporter.scopeEnd(mochaSuite); }; }; }); runner.on(&quot;test&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.chunk) reporter.chunk(mochaTest); }; }); runner.on(&quot;test end&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.chunkEnd) reporter.chunkEnd(mochaTest); }; }); runner.on(&quot;hook&quot;, mochaHook =&gt; { for (var reporter of reporters) { if (reporter.hook) reporter.hook(mochaHook); }; }); runner.on(&quot;hook end&quot;, mochaHook =&gt; { for (var reporter of reporters) { if (reporter.hookEnd) reporter.hookEnd(mochaHook); }; }); runner.on(&quot;pass&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.pass) reporter.pass(mochaTest); }; }); runner.on(&quot;fail&quot;, (mochaTest, err) =&gt; { CONF.isRunPassed = false; if (CONF.curTestCase) { var errMsg = mochaTest.title; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; }; if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; }; if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); }; CONF.curTestCase.addError(errMsg); CONF.curTestCase.addFailedParams( _.clone(CONF.curTestCase.testParams)); }; for (var reporter of reporters) { if (reporter.fail) reporter.fail(mochaTest, err); }; }); runner.on(&quot;pending&quot;, mochaTest =&gt; { for (var reporter of reporters) { if (reporter.pending) reporter.pending(mochaTest); }; }); }; util.inherits(GlaceReporter, MochaReporter); module.exports = GlaceReporter; /** * Finalizes reporting. * * @function * @async * @arg {Array.&lt;*&gt;} failures - Tests failures. * @arg {function} fn - Finalizator. */ GlaceReporter.prototype.done = function (failures, fn) { var prms = Promise.resolve(); reporters.forEach(reporter =&gt; { if (reporter.done) { prms = prms .then(() =&gt; reporter.done()) .catch(e =&gt; LOG.error(e)); }; }); prms.then(() =&gt; fn(failures)); }; /** * Registers reporters if they are not. * * @method * @static * @arg {...object} reporters - Sequence of reporters to register. */ GlaceReporter.register = function () { for (var reporter of arguments) { if (!reporters.includes(reporter)) { reporters.push(reporter); }; }; }; /** * Removes reporters if they are registered. * * @method * @static * @arg {...object} reporters - Sequence of reporters to remove. */ GlaceReporter.remove = function () { reporters = _.without.apply(_, reporters, arguments); }; /** * Helper to define whether `MochaJS` suite is `GlaceJS` test or no. * * It iterates among registered tests and check if suite name matches name * someone of tests. It is not possible to use `CONF.curTestCase` to compare * because `CONF.curTestCase` is assigned after event `suite`. * * @function * @ignore * @arg {object} mochaSuite - `MochaJS` suite. * @return {boolean} - `true` if `MochaJS` suite is `GlaceJS` test, `false` * otherwise. */ var _isSuiteTest = mochaSuite =&gt; { for (var testCase of CONF.testCases) { if (mochaSuite.title === testCase.name) { return true; }; }; return false; }; × Search results Close "},"cli.js.html":{"id":"cli.js.html","title":"Source: cli.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: cli.js &quot;use strict&quot;; /** * Contains functions to execute tests via command line interface. * * @module */ require(&quot;./help&quot;); var path = require(&quot;path&quot;); var run = require(&quot;./run&quot;); /** * Runs `GlaceJS` in CLI. * * @function */ module.exports.run = () =&gt; run(process.exit); × Search results Close "},"config.js.html":{"id":"config.js.html","title":"Source: config.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: config.js &quot;use strict&quot;; /** * Configures `GlaceJS` before tests run. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var argv = require(&quot;yargs&quot;).argv var expect = require(&quot;chai&quot;).expect; var fse = require(&quot;fs-extra&quot;); var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; if (process.platform === &quot;win32&quot;) { var binary = require(&quot;binary&quot;); binary.activateFFmpeg(); binary.activateImageMagick(); }; /* Configure plugins */ var plugins = [ &quot;glacejs-proxy&quot;, ]; for (var plugin of plugins) { try { require(plugin).config; } catch (e) { LOG.warn(`Plugin '${plugin}' isn't installed`); }; }; var config = U.config; var args = config.args; /* Set up test folders */ if (args._ &amp;&amp; args._.length) { var targets = args._; } else if (args.targets &amp;&amp; args.targets.length) { var targets = args.targets; } else { var targets = [&quot;tests&quot;]; }; var testDirs = targets.map(target =&gt; path.resolve(U.cwd, target)) /* Set up reports folder */ var reportsDir = path.resolve(U.cwd, (args.report || &quot;reports&quot;)); if (fs.existsSync(reportsDir)) fse.removeSync(reportsDir); fse.mkdirsSync(reportsDir); /* Set up default config */ /** * Contains `GlaceJS` main configuration. * * @namespace GlaceConfig * @property {?TestCase} [curTestCase=null] - Pointer to current test case object. * On tests run it points to `null`. The pointer changes when a test launches. * @property {TestCase[]} [testCases=[]] - List of all executed test cases. It * populates when a test launches. It is used to store full information about * executed tests and may be used in reporter. * @property {string} testDirs - Path to test directories or test modules. * If it contains path to directory, tests will be loaded recursive from it. * By default `GlaceJS` tries to load tests from `tests` folder in current * work directory. * @property {string} reportsDir - Path to directory where reports will be put. * By default `GlaceJS` tries to put reports to `reports` folder in current * work directory. * @property {object} log - Logger settings. * @property {string} log.file - Path to common logger file, which is * `glacejs.log` inside current work directory. * @property {string} [log.level=debug] - Common logger level. * @property {object} webdriver - Webdriver settings. Corresponds to * `webdriverio` remote settings. * @property {boolean} [isWeb=false] - Flag to launch tests in browser. * @property {string} appUrl - URL of web application. * @property {boolean} [noDriversInstall=true] - Flag to not install selenium * drivers on start. * @property {string} [platform=pc] - Platform type where should launch tests. * Permitted values are `pc`, `android`, `ios`. * @property {string} browserName - Name of browser where tests will be * executed. Default value depends on platform. `Chrome` for `pc`, `chrome` * for `android`, `safari` for `ios`. * @property {number} [testRetries=0] - Number of times to retry a failed test. * @property {boolean} [stdoutLog=false] - Flag to print log message in stdout. * @property {boolean} [toTestrail=false] - Flag to plug `testrail` reporter. * @property {string} [grep] - Filter for test cases. * @property {boolean} [suppressUncaught=false] - Suppress uncaught exceptions * processing by mochajs. * @property {boolean} [isDesktop=false] - Flag that tests are launched on * desktop. * @property {boolean} [isMobile=false] - Flag that tests are launched on * mobile device. * @property {boolean} [isAndroid=false] - Flag that tests are launched on * android device. * @property {boolean} [isIos=false] - Flag that tests are launched on iOS * device. */ var config = module.exports = _.merge(config, { curTestCase: null, testCases: [], testDirs: testDirs, reportsDir: reportsDir, timeouts: { testCase: 180000, pageLoad: 60000, uiAction: 10000, proxy: 60000, }, testrail: { host: null, user: null, token: null, }, cache: { ttl: Number.MAX_SAFE_INTEGER, size: 10 * 1024 * 1024 * 1024, }, isRunPassed: null, languages: [], webdriver: {} // will be configured below }); config.proxy = config.proxy || {}; /* Use CLI arguments */ config.uncaught = (args.uncaught || &quot;log&quot;).toLowerCase(); expect([ &quot;log&quot;, &quot;fail&quot;, &quot;mocha&quot; ], &quot;Invalid `--uncaught` value&quot;).include(config.uncaught); config.rootConftest = args.rootConftest; config.isWeb = !!args.web; // default `false` config.appUrl = args.app; config.installDrivers = !args.dontInstallDrivers &amp;&amp; !args.seleniumAddr; // default `true` config.platform = args.platform || &quot;pc&quot;; expect([&quot;pc&quot;, &quot;android&quot;, &quot;ios&quot;], &quot;Invalid `--platform` value&quot;).include(config.platform); config.browserName = args.browser; // default is platform specific config.testRetries = args.retry || 0; config.chunkRetries = args.chunkRetry || 0; expect(config.testRetries).gte(0); config.stdoutLog = !!args.stdoutLog; // default `false` config.toTestrail = !!args.testrail; // default `false` config.grep = args.grep; config.suppressUncaught = !args.allowUncaught; // default `false` config.useXvfb = !!args.xvfb; // default `false` if (typeof(args.xvfb) === &quot;number&quot;) { args.xvfb = String(args.xvfb); }; if (typeof(args.xvfb) === &quot;string&quot;) { var width, height; [ width, height ] = args.xvfb.split(&quot;x&quot;); expect(width &amp;&amp; height, &quot;Invalid `xvfb` options. Use variants &quot; + &quot;`--xvfb` or `--xvfb &lt;width&gt;x&lt;height&gt;`&quot;).to.exist; config.xvfbWidth = width; config.xvfbHeight = height; }; config.captureVideo = !!args.video || !!args.forceVideo; // default `false` config.forceVideo = !!args.forceVideo; // default `false` if (args.languages) { config.languages = _.filter(_.map(args.languages.split(','), el =&gt; el.trim())); }; /* Configure webdriver */ var desired = config.webdriver.desiredCapabilities = {}; if (args.seleniumAddr) { var host, port; [host, port] = args.seleniumAddr.split(':'); if (host) config.webdriver.host = host; if (port) config.webdriver.port = port; }; if (config.platform === &quot;pc&quot;) { config.isDesktop = true; desired.browserName = config.browserName || &quot;chrome&quot;; if (desired.browserName === &quot;chrome&quot;) { desired.chromeOptions = { args: [ &quot;test-type&quot;, &quot;start-maximized&quot;, &quot;disable-infobars&quot;, &quot;enable-precise-memory-info&quot; ], prefs: { &quot;credentials_enable_service&quot;: false, &quot;profile&quot;: { &quot;password_manager_enabled&quot;: false, }, }, }; }; } else { config.isMobile = true; desired.deviceName = args.device; desired.platformVersion = String(args.osVersion); if (args.udid) { desired.udid = args.udid; }; if (config.platform === &quot;android&quot;) { config.isAndroid = true; desired.browserName = args.browser || &quot;chrome&quot;; desired.platformName = &quot;Android&quot;; }; if (config.platform === &quot;ios&quot;) { config.isIos = true; desired.browserName = args.browser || &quot;safari&quot;; desired.platformName = &quot;iOS&quot;; desired.automationName = args.iosEngine || &quot;XCUITest&quot;; }; }; /* Merge user config */ var userConfig = {}; var userConfigPath = path.resolve(U.cwd, (args.config || &quot;config.js&quot;)); if (fs.existsSync(userConfigPath)) { userConfig = require(userConfigPath); }; _.assign(config, userConfig); × Search results Close "},"error.js.html":{"id":"error.js.html","title":"Source: error.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: error.js &quot;use strict&quot;; /** * Contains `GlaceJS` errors. * * @module */ var util = require(&quot;util&quot;); var BaseError = require(&quot;es6-error&quot;); /** * Error which is thrown in `GlaceJS`, if no more specific error is defined. * * @class * @arg {string} message - Error message. */ var GlaceError = module.exports.GlaceError = function (message) { BaseError.call(this, message); }; util.inherits(GlaceError, BaseError); /** * Error which is thrown when configuration is wrong. * * @class * @arg {string} message - Error message. */ var ConfigError = module.exports.ConfigError = function (message) { GlaceError.call(this, message); }; util.inherits(ConfigError, GlaceError); /** * Error which is thrown when step execution is wrong. * * @class * @arg {string} message - Error message. */ var StepError = module.exports.StepError = function (message) { GlaceError.call(this, message); }; util.inherits(StepError, GlaceError); × Search results Close "},"hacking.js.html":{"id":"hacking.js.html","title":"Source: hacking.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: hacking.js &quot;use strict&quot;; /** * Contains hacks for test run. * * @module */ var LOG = require(&quot;glacejs-utils&quot;).logger; var Mocha = require(&quot;mocha&quot;); var Pending = require(&quot;mocha/lib/pending&quot;); var CONF = require(&quot;./config&quot;); /** * Patches original `Mocha.Runner.prototype.uncaught` in order to skip * exceptions from proxy server `res.send()`. * * @function */ module.exports.suppressMochaUncaught = () =&gt; { Mocha.Runner.prototype.uncaught = function (err) { LOG.error(&quot;UNCAUGHT EXCEPTION&quot;, err); if (CONF.uncaught === &quot;fail&quot;) { if (CONF.curTestCase) { var errMsg = &quot;Uncaught exception&quot;; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; }; if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; }; if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); }; CONF.curTestCase.addError(errMsg); }; }; return; }; }; /** * Mocha runner. * * @type {Runner} */ var _mochaRunner; (grep =&gt; { Mocha.Runner.prototype.grep = function() { _mochaRunner = this; return grep.apply(this, arguments); }; })(Mocha.Runner.prototype.grep); /** * Gets mocha runner. * * @function */ module.exports.getRunner = () =&gt; _mochaRunner; /** * Patches mocha runner to allow multiple independent `after`-calls. */ Mocha.Runner.prototype.hook = function (name, fn) { var suite = this.suite; var hooks = suite['_' + name]; var self = this; function next (i) { var hook = hooks[i]; if (!hook) { return fn(); } self.currentRunnable = hook; hook.ctx.currentTest = self.test; self.emit('hook', hook); if (!hook.listeners('error').length) { hook.on('error', function (err) { self.failHook(hook, err); }); } hook.run(function (err) { var testError = hook.error(); if (testError) { self.fail(self.test, testError); } if (err) { if (err instanceof Pending) { if (name === 'beforeEach' || name === 'afterEach') { self.test.pending = true; } else { utils.forEach(suite.tests, function (test) { test.pending = true; }); // a pending hook won't be executed twice. hook.pending = true; } } else { self.failHook(hook, err); // stop executing hooks, notify callee of hook err if (!name.startsWith(&quot;after&quot;)) return fn(err); } } self.emit('hook end', hook); delete hook.ctx.currentTest; next(++i); }); } Mocha.Runner.immediately(function () { next(0); }); }; × Search results Close "},"help.js.html":{"id":"help.js.html","title":"Source: help.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: help.js &quot;use strict&quot;; /** * Help description. * * @module */ require(&quot;colors&quot;); var U = require(&quot;glacejs-utils&quot;); var d = U.switchColor(); var argv = require(&quot;yargs&quot;) .usage(&quot;\\nglace [options] [test-files-or-folders]&quot;.white.bold) .options({ /* configuration */ &quot;args-config&quot;: { describe: d(&quot;Path to JSON file with CLI arguments.&quot;, &quot;Default is 'cwd/args.json' (if it exists).&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;config&quot;: { describe: d(&quot;Path to JS file with configuration which will be&quot;, &quot;merged with override default configuration.&quot;, &quot;Default is 'cwd/config.js' (if it exists).&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;grep&quot;: { describe: d(&quot;Filter tests by name or name chunk.&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;root-conftest&quot;: { describe: d(&quot;Path to root conftest.js which will be loaded&quot;, &quot;before all.&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;languages&quot;: { describe: d(&quot;List of tested languages separated with comma.&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;retry&quot;: { describe: d(&quot;Number of times to retry failed test.&quot;, &quot;Default is 0.&quot;), type: &quot;number&quot;, group: &quot;Configuration:&quot;, }, &quot;chunk-retry&quot;: { describe: d(&quot;Number of times to retry failed chunk.&quot;, &quot;Default is 0.&quot;), type: &quot;number&quot;, group: &quot;Configuration:&quot;, }, &quot;uncaught&quot;: { describe: d(&quot;Strategy to process of uncaught exceptions.&quot;, &quot;Supported values are 'log', 'fail', 'mocha'.&quot;, &quot;Default value is 'log'.&quot;), type: &quot;string&quot;, group: &quot;Configuration:&quot;, }, &quot;stdout-log&quot;: { describe: d(&quot;Print log messages to stdout.&quot;), type: &quot;boolean&quot;, group: &quot;Configuration:&quot;, }, &quot;testrail&quot;: { describe: d(&quot;Plug in testrail reporter.&quot;), type: &quot;boolean&quot;, group: &quot;Configuration:&quot;, }, /* selenium */ &quot;dont-install-drivers&quot;: { describe: d(&quot;Flag to not install selenium drivers on tests run.&quot;), type: &quot;boolean&quot;, group: &quot;Selenium:&quot;, }, &quot;web&quot;: { describe: d(&quot;Flag to launch tests in browser. Browser will be&quot;, &quot;launched on session start and closed on session finish.&quot;), type: &quot;boolean&quot;, group: &quot;Selenium:&quot;, }, &quot;app&quot;: { describe: d(&quot;Application URL which will be used for web tests.&quot;), type: &quot;string&quot;, group: &quot;Selenium:&quot;, }, &quot;selenium-addr&quot;: { describe: d(&quot;Connect to launched selenium server with this address.&quot;), type: &quot;string&quot;, group: &quot;Selenium:&quot;, }, &quot;platform&quot;: { describe: d(&quot;Specify platform type where tests will be executed.&quot;, &quot;Default is 'pc'.&quot;), type: &quot;string&quot;, choices: [ &quot;pc&quot;, &quot;android&quot;, &quot;ios&quot; ], group: &quot;Selenium:&quot;, }, &quot;browser&quot;: { describe: d(&quot;Name of browser where web tests will be&quot;, &quot;executed. Default value is platform specific.&quot;), type: &quot;string&quot;, group: &quot;Selenium:&quot;, }, /* appium */ &quot;device&quot;: { describe: d(&quot;Mobile device name.&quot;), type: &quot;string&quot;, group: &quot;Appium:&quot;, }, &quot;os-version&quot;: { describe: d(&quot;Mobile operating system version.&quot;), type: &quot;string&quot;, group: &quot;Appium:&quot;, }, &quot;ios-engine&quot;: { describe: d(&quot;iOS automation engine name.&quot;), type: &quot;string&quot;, group: &quot;Appium:&quot;, }, /* video */ &quot;video&quot;: { describe: d(&quot;Capture video of executed tests.&quot;, &quot;Video will be removed if test is passed.&quot;), type: &quot;boolean&quot;, group: &quot;Video:&quot;, }, &quot;force-video&quot;: { describe: d(&quot;Capture video of executed tests.&quot;, &quot;Video will be saved even if test is passed.&quot;), type: &quot;boolean&quot;, group: &quot;Video:&quot;, }, /* proxy */ &quot;proxy&quot;: { describe: d(&quot;Use http proxy.&quot;), type: &quot;boolean&quot;, group: &quot;Proxy:&quot;, }, &quot;proxy-port&quot;: { describe: d(&quot;Port for http proxy. Default is random.&quot;), type: &quot;number&quot;, group: &quot;Proxy:&quot;, }, &quot;global-proxy&quot;: { describe: d(&quot;Use transparent global proxy. Chromium browsers only.&quot;), type: &quot;boolean&quot;, group: &quot;Proxy:&quot;, }, &quot;global-proxy-port&quot;: { describe: d(&quot;Port for transparent global proxy. Default is 8888.&quot;), type: &quot;number&quot;, group: &quot;Proxy:&quot;, }, &quot;install-certificate&quot;: { describe: d(&quot;Install global proxy certificate as trusted.&quot;, &quot;Requires administrator permissions.&quot;), type: &quot;boolean&quot;, group: &quot;Proxy:&quot;, }, &quot;cache&quot;: { describe: d(&quot;Enable middleware to cache proxy responses to disk.&quot;), type: &quot;boolean&quot;, group: &quot;Proxy:&quot;, }, &quot;existing-cache&quot;: { describe: d(&quot;Use existing cache if it exists.&quot;), type: &quot;boolean&quot;, group: &quot;Proxy:&quot;, }, &quot;reconnect&quot;: { describe: d(&quot;Number of proxy reconnects on request error.&quot;, &quot;Default is 1.&quot;), type: &quot;number&quot;, group: &quot;Proxy:&quot;, }, /* virtual display */ &quot;xvfb&quot;: { describe: d(&quot;Use xvfb for headless testing&quot;), type: &quot;string&quot;, group: &quot;Virtual display:&quot;, }, }) .help(&quot;h&quot;) .alias(&quot;h&quot;, &quot;help&quot;) .epilog(&quot;Have a green test ;)&quot;.green.bold) .argv; × Search results Close "},"image.js.html":{"id":"image.js.html","title":"Source: image.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: image.js &quot;use strict&quot;; /** * Contains classes and functions to process images. * * @module */ var sharp = require(&quot;sharp&quot;); var temp = require(&quot;temp&quot;); var U = require(&quot;glacejs-utils&quot;); sharp.cache(false); /** * Creates new instance of Image. * * @class * @arg {string} srcPath - path to processed image * @arg {object} [srcOpts] - image options * @arg {number} [srcOpts.scaleX] - image current scale value on `X` axis * @arg {number} [srcOpts.scaleY] - image current scale value on `Y` axis */ var Image = module.exports = function (srcPath, srcOpts) { if (!(this instanceof Image)) return new Image(srcPath, srcOpts); srcOpts = U.defVal(srcOpts, {}); srcOpts.scaleX = U.defVal(srcOpts.scaleX, 1); srcOpts.scaleY = U.defVal(srcOpts.scaleY, 1); this._srcPath = srcPath; this._srcOpts = srcOpts; }; /** * Defines whether processed image is transparent. * * @async * @method * @return {Promise.&lt;boolean&gt;} - `true` if image is transparent, `false` * otherwise. */ Image.prototype.isTransparent = function () { return this._loadImg(this._srcPath, this._srcOpts).then(image =&gt; { var pixels = this._getPixels(image); var height = pixels.length; var width = pixels[0].length; for (var y = 0; y &lt; height; y++) { var row = pixels[y]; for (var x = 0; x &lt; width; x++) { if (row[x].A !== 0) return false; }; }; return true; }); }; /** * Defines whether processed image is monochrome. * * @async * @method * @return {Promise.&lt;boolean&gt;} - `true` if image is monochrome, `false` * otherwise. */ Image.prototype.isMonochrome = function () { return this._loadImg(this._srcPath, this._srcOpts).then(image =&gt; { var pixels = this._getPixels(image); var height = pixels.length; var width = pixels[0].length; var firstPixel = pixels[0][0]; for (var y = 0; y &lt; height; y++) { var row = pixels[y]; for (var x = 0; x &lt; width; x++) { if (row[x].A !== firstPixel.A || row[x].R !== firstPixel.R || row[x].G !== firstPixel.G || row[x].B !== firstPixel.B) { return false; }; }; }; return true; }); }; /** * Defines whether processed image is black. * * @async * @method * @return {Promise.&lt;boolean&gt;} - `true` if image is black, `false` otherwise. */ Image.prototype.isBlack = function () { return this._loadImg(this._srcPath, this._srcOpts).then(image =&gt; { var pixels = this._getPixels(image); var height = pixels.length; var width = pixels[0].length; for (var y = 0; y &lt; height; y++) { var row = pixels[y]; for (var x = 0; x &lt; width; x++) { if (row[x].A !== 255 || row[x].R !== 0 || row[x].G !== 0 || row[x].B !== 0) { return false; }; }; }; return true; }); }; /** * Defines whether processed image is white. * * @async * @method * @return {Promise.&lt;boolean&gt;} - `true` if image is white, `false` otherwise. */ Image.prototype.isWhite = function () { return this._loadImg(this._srcPath, this._srcOpts).then(image =&gt; { var pixels = this._getPixels(image); var height = pixels.length; var width = pixels[0].length; for (var y = 0; y &lt; height; y++) { var row = pixels[y]; for (var x = 0; x &lt; width; x++) { if (row[x].A !== 255 || row[x].R !== 255 || row[x].G !== 255 || row[x].B !== 255) { return false; }; }; }; return true; }); }; /** * Defines if processed image includes specified image. * * @method * @arg {string} dstPath - path to potentially included image * @arg {object} [dstOpts] - included image options * @arg {number} [dstOpts.tolerance=0.05] - comparison tolerance * @arg {?string} [dstOpts.matchedPath=null] - path to same captured place * @arg {boolean} [dstOpts.saveMatch=false] - flag to capture images * intersection or no * @return {Promise.&lt;object&gt;} - result */ Image.prototype.includes = function (dstPath, dstOpts) { dstOpts = U.defVal(dstOpts, {}); dstOpts.scaleX = U.defVal(dstOpts.scaleX, 1); dstOpts.scaleY = U.defVal(dstOpts.scaleY, 1); this._dstPath = dstPath; this._dstOpts = dstOpts; this._tolerance = U.defVal(dstOpts.tolerance, .05); this._matchedPath = U.defVal(dstOpts.matchedPath); this._saveMatch = U.defVal(dstOpts.saveMatch, !!this._matchedPath); if (this._saveMatch &amp;&amp; !this._matchedPath) this._matchedPath = temp.path({ suffix: '.png' }); this._pixelDenominator = 255 * Math.sqrt(3); var srcImage; return this._loadImg(this._srcPath, this._srcOpts).then(image =&gt; { srcImage = image; return this._loadImg(this._dstPath, this._dstOpts); }).then(dstImage =&gt; { return this._includes(srcImage, dstImage); }).then(result =&gt; { if (!result.isIncluded) return { isIncluded: false }; if (!this._saveMatch) return result; return this ._saveMatchImage(result.offsetX, result.offsetY, result.width, result.height) .then(() =&gt; { result.matchedPath = this._matchedPath; return result; }); }); }; /** * Loads image. * * @method * @protected * @arg {string} imgPath - path loaded image * @arg {object} imgOpts - image options * @return {Promise.&lt;object&gt;} - image data */ Image.prototype._loadImg = function(imgPath, imgOpts) { var width, height, hasAlpha, channels; var img = sharp(imgPath); return img.metadata().then(metadata =&gt; { hasAlpha = metadata.hasAlpha; channels = metadata.channels; width = Math.ceil(metadata.width / imgOpts.scaleX); height = Math.ceil(metadata.height / imgOpts.scaleY); return img.resize(width, height).raw().toBuffer(); }).then(data =&gt; { return { width: width, height: height, data: data, channels: channels, hasAlpha: hasAlpha }; }); }; /** * Saves matched part of image. * * @method * @protected * @arg {number} left - offset from left image border * @arg {number} top - offset from top image border * @arg {number} width - width of matched part * @arg {number} height - height of matched part * @return {Promise} */ Image.prototype._saveMatchImage = function (left, top, width, height) { return sharp(this._srcPath) .extract({ left: left, top: top, width: width, height: height }) .toFile(this._matchedPath); }; /** * Defines whether one image data includes another. * * @method * @protected * @arg {object} src - source image data * @arg {object} dst - destination image data, which is potentially included * @return {object} - result */ Image.prototype._includes = function (src, dst) { var srcPixels = this._cropPixels(this._getPixels(src)), dstPixels = this._cropPixels(this._getPixels(dst)); var offsetX, offsetY, diffValue, x, y, pixels; var dstUsedPixels = [], dstWidth = dstPixels[0].length, dstHeight = dstPixels.length; var result = { isIncluded: false, diffValue: null, offsetX: null, offsetY: null, width: dstWidth, height: dstHeight }; var deltaX = srcPixels[0].length - dstWidth, deltaY = srcPixels.length - dstHeight; for (y = 0; y &lt; dstHeight; y++) { pixels = dstPixels[y]; for (x = 0; x &lt; dstWidth; x++) { if (this._isPixelUsed(pixels[x])) dstUsedPixels.push({ pixel: pixels[x], x: x, y: y }); }; }; for (offsetY = 0; offsetY &lt;= deltaY; offsetY++) { for (offsetX = 0; offsetX &lt;= deltaX; offsetX++) { diffValue = this._getDiffValue(srcPixels, dstUsedPixels, offsetX, offsetY); if (diffValue === null) continue; if (result.diffValue === null || result.diffValue &gt; diffValue) { result.isIncluded = true; result.diffValue = diffValue; result.offsetX = offsetX; result.offsetY = offsetY; }; if (diffValue === 0 || !this._saveMatch) return result; }; }; return result; }; /** * Calculates difference between source pixels and destination pixels. * * @method * @protected * @arg {object[][]} - source pixels matrix * @arg {object[][]} - destination pixels matrix * @arg {number} offsetX - source left border offset * @arg {number} offsetY - source top border offset * @return {number} - difference value */ Image.prototype._getDiffValue = function (srcPixels, dstPixels, offsetX, offsetY) { var diffPixels = 0, limit = this._tolerance * dstPixels.length, dstPixel, srcPixel, i; for (i = 0; i &lt; dstPixels.length; i++) { dstPixel = dstPixels[i]; srcPixel = srcPixels[offsetY + dstPixel.y][offsetX + dstPixel.x]; if (this._isPixelTolerant(srcPixel, dstPixel.pixel)) continue; diffPixels++; if (diffPixels &gt; limit) return null; }; return diffPixels / dstPixels.length; }; /** * Defines whether pixel should be used for difference calculation or no, * according its alpha value. * * @method * @protected * @arg {object} pixel - pixel * @return {boolean} - `true` if should be, `false` otherwise */ Image.prototype._isPixelUsed = function (pixel) { return (255 - pixel.A) / 255 &lt; this._tolerance; }; /** * Defines whether source pixel is tolerant to destination pixel. * * @method * @protected * @arg {object} srcPixel - source pixel * @arg {object} dstPixel - destination pixel * @return {boolean} - `true` if pixels are tolerant, `false` otherwise */ Image.prototype._isPixelTolerant = function(srcPixel, dstPixel) { var deltaR = srcPixel.R - dstPixel.R, deltaG = srcPixel.G - dstPixel.G, deltaB = srcPixel.B - dstPixel.B; return Math.sqrt(deltaR * deltaR + deltaG * deltaG + deltaB * deltaB) / this._pixelDenominator &lt; this._tolerance; }; /** * Retrieves pixels from image data. * * @method * @protected * @arg {object} img - image data * @return {object[][]} - pixels matrix */ Image.prototype._getPixels = function (img) { var pixels = [], height = img.height, width = img.width * img.channels, x, y, offset; for (y = 0; y &lt; height; y++) { offset = width * y; pixels.push([]); for (var x = 0; x &lt; width; x += img.channels) { pixels[y].push({ R: img.data[offset + x], G: img.data[offset + x + 1], B: img.data[offset + x + 2], A: img.hasAlpha ? img.data[offset + x + 3] : 255, }); }; }; return pixels; }; /** * Crops pixels, removes empty rows and columns. * * @method * @protected * @arg {object[][]} pixels - pixels matrix * @return {object[][]} - cropped pixels matrix */ Image.prototype._cropPixels = function (pixels) { pixels = this._cropTop(pixels); pixels.reverse(); pixels = this._cropTop(pixels); pixels.reverse(); pixels = this._transpose(pixels); pixels = this._cropTop(pixels); pixels.reverse(); pixels = this._cropTop(pixels); pixels.reverse(); return this._transpose(pixels); }; /** * Crops top part of pixels matrix. * * @method * @protected * @arg {object[][]} pixels - pixels matrix * @return {object[][]} - cropped pixels matrix */ Image.prototype._cropTop = function (pixels) { var croppedPixels = [], isTransparent = true, width = pixels[0].length, height = pixels.length, x, y, pixelsRow; for (y = 0; y &lt; height; y++) { pixelsRow = pixels[y]; if (isTransparent) { for (x = 0; x &lt; width; x++) { if (pixelsRow[x].A !== 0) { isTransparent = false; break; }; }; }; if (!isTransparent) croppedPixels.push(pixelsRow); }; return croppedPixels; }; /** * Transposes pixels matrix. * * @method * @arg {object[][]} pixels - pixels matrix * @return {object[][]} transposed pixels matrix */ Image.prototype._transpose = function (pixels) { var width = pixels[0].length, height = pixels.length, tPixels = [], x, y; if (width === 0 || height === 0) return []; for (y = 0; y &lt; width; y++) { tPixels[y] = []; for (x = 0; x &lt; height; x++) { tPixels[y][x] = pixels[x][y]; }; }; return tPixels; }; × Search results Close "},"index.js.html":{"id":"index.js.html","title":"Source: index.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: index.js &quot;use strict&quot;; /** * `GlaceJS` main module. * * @module * * @prop {object} config - {@link module:config|Config} module. * @prop {object} error - {@link module:error|Error} module. * @prop {object} Page - {@link module:page/index|Page} module. * @prop {object} reporter - {@link module:reporter/index|Reporter} module. * @prop {object} run - {@link module:run|run} module. * @prop {object} Steps - {@link module:steps|Steps} module. */ var config, error, Page, reporter, run, Steps; Object.defineProperties(exports, { /** * @type {GlaceConfig} */ config: { get: function() { config = config || require(&quot;./config&quot;); return config; }, }, error: { get: function() { error = error || require(&quot;./error&quot;); return error; }, }, /** * @type {Page} */ Page: { get: function() { Page = Page || require(&quot;./page&quot;); return Page; }, }, /** * @type {GlaceReporter} */ reporter: { get: function() { reporter = reporter || require(&quot;./reporter&quot;); return reporter; }, }, /** * @type {run} */ run: { get: function() { run = run || require(&quot;./run&quot;); return run; }, }, /** * @type {Steps} */ Steps: { get: function() { Steps = Steps || require(&quot;./steps&quot;); return Steps; }, }, }); × Search results Close "},"matcher.js.html":{"id":"matcher.js.html","title":"Source: matcher.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: matcher.js &quot;use strict&quot;; /** * Matchers. * * @module */ var _ = require(&quot;lodash&quot;); var Assertion = require(&quot;chai&quot;).Assertion; /** * Checks that correct condition were added correctly. * * @param {string} cond - conditions for assertion. * @param {string} [msg] - message to throw in case of wrong conditions. * @example await SS.checkBalance({ &quot;to be not equal&quot;: 100 }) Steps.prototype.checkBalance = async function (condition) { var currBalance = await this.getBalance(); expect(currBalance).correspond(condition, &quot;Invalid user balance&quot;); }; */ Assertion.prototype.correspond = function (cond, msg) { var matchers, expVal; if (msg) this.__flags.message = msg; if (typeof(cond) === &quot;object&quot;) { if (Object.keys(cond).length !== 1) { throw new Error(&quot;Condition should contain only one key-value pair&quot;); } matchers = Object.keys(cond)[0]; expVal = Object.values(cond)[0]; } else if (typeof(cond) === &quot;string&quot;) { matchers = cond; } else { throw new Error(&quot;Condition should be string or object only&quot;); } matchers = _.filter(_.split(matchers, &quot; &quot;)); var predicate = this; for (var matcher of matchers) { predicate = predicate[matcher]; if (!predicate) throw new TypeError(`Undefined matcher '${matcher}'`); } if (expVal) predicate.call(this, expVal); return this; }; × Search results Close "},"page_element.js.html":{"id":"page_element.js.html","title":"Source: page/element.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: page/element.js &quot;use strict&quot;; /** * Defines classes responsible for interaction with DOM in browser context. * * @module */ var weak = require(&quot;weak&quot;); var U = require(&quot;glacejs-utils&quot;); var PointerEvents = require(&quot;./event&quot;).PointerEvents; /** * Creates a new instance of `Element`. * * `Element` binds DOM control in browser context with virtual control in test. * * @class * @arg {string} name - control name * @arg {object} driver - selenium driver instance */ var Element = module.exports = function (name, selector, page) { this.name = name; this.selector = selector; this.event = new PointerEvents(selector, page); this._page = weak(page); this._elCmd = `document.querySelector(&quot;${this.selector}&quot;)`; }; /** * Gets webdriver element. * * @method * @return {object} - Webdriver element. */ Element.prototype.getElement = function () { return this._page.getDriver().element(this.selector); }; /** * Gets text content of DOM element. * * @method * @return {Promise.&lt;string&gt;} - text value or null */ Element.prototype.getText = function () { return this._page.getDriver().getText(this.selector).then(value =&gt; { if (value) return value.trim(); return this._page.getDriver().getAttribute(this.selector, &quot;value&quot;); }).then(value =&gt; { if (value) return value.trim(); return this._page.getDriver().getAttribute(this.selector, &quot;innerHTML&quot;); }).then(value =&gt; { if (value) return value.trim(); return null; }); }; /** * Sets text to DOM element. * * @method * @arg {string} text - Text value to assign. * @return {Promise} */ Element.prototype.setText = function (text) { return this._page.getDriver().setValue(this.selector, text); }; /** * Gets DOM control location with attributes: * `x`, `y`, `midX`, `midY`, `width`, `height` * * @method * @return {Promise.&lt;object&gt;} - location of control */ Element.prototype.location = function () { var cmd = ` \\ var ctrl = ${this._elCmd}; \\ var rect = ctrl.getBoundingClientRect(); \\ var location = {}; \\ location.x = Math.ceil(rect.left); \\ location.y = Math.ceil(rect.top); \\ location.width = Math.ceil(rect.width); \\ location.height = Math.ceil(rect.height); \\ location.midX = Math.ceil(location.x + location.width / 2); \\ location.midY = Math.ceil(location.y + location.height / 2); \\ return location;`; return this._page.getDriver().execute(cmd).then(result =&gt; result.value); }; /** * Scrolls control into browser viewport. * * @method * @return {Promise.&lt;*&gt;} - result of javascript execution in browser context */ Element.prototype.scrollIntoView = function () { var cmd = &quot;return &quot; + this._elCmd + &quot;.scrollIntoView();&quot;; return this._page.getDriver().execute(cmd).then(result =&gt; { return result.value; }); }; /** * Clicks control in browser. * * @method * @return {Promise} - result of selenium execution in browser context */ Element.prototype.click = function () { return this.waitForVisible().then(() =&gt; { return this.scrollIntoView(); }).then(() =&gt; { return this._page.getDriver().click(this.selector); }); }; /** * Clicks element in browser via pointer events. * * @method * @return {Promise} */ Element.prototype.pClick = function () { var x, y; return this.waitForVisible().then(() =&gt; { return this.location(); }).then(loc =&gt; { x = loc.midX; y = loc.midY; return this.event.move(x, y); }).then(() =&gt; { return this.event.down(x, y); }).then(() =&gt; { console.log(x, y); return this.event.up(x, y); }); }; /** * Taps control in browser. * * @method */ Element.prototype.tap = Element.prototype.click; /** * Defines whether control is selected or no. * * @method * @return {Promise.&lt;boolean&gt;} - `true` if control is selected, `false` otherwise */ Element.prototype.isSelected = function () { return this._page.getDriver().isSelected(this.selector).then(result =&gt; { if (result) return true; return this._page.getDriver().getAttribute(this.selector, &quot;class&quot;).then(result =&gt; { return result.includes(&quot;selected&quot;); }); }); }; /** * Defines whether control is exist or no. * * @method * @return {Promise.&lt;boolean&gt;} - `true` if control is exist, `false` otherwise */ Element.prototype.isExist = function () { var cmd = &quot;return !!&quot; + this._elCmd + &quot;;&quot;; return this._page.getDriver().execute(cmd).then(result =&gt; result.value); }; /** * Waits for control is exist. * * @method * @arg {number} [timeout] - timeout to wait, ms * @return {Promise.&lt;*&gt;} - result of selenium execution * @throws {TimeoutError} - If control isn't exist after timeout. */ Element.prototype.waitForExist = function (timeout) { var timeout = U.defVal(timeout, CONF.timeouts.uiAction); var errMsg = this.name + &quot; isn't exist after &quot; + timeout + &quot; ms&quot;; return this._page.getDriver().waitUntil(async () =&gt; { return await this.isExist(); }, timeout, errMsg); }; /** * Waits for control isn't exist. * * @method * @arg {number} [timeout] - timeout to wait, ms * @return {Promise.&lt;*&gt;} - result of selenium execution * @throws {TimeoutError} - If control is still exist after timeout. */ Element.prototype.waitForNonExist = function (timeout) { var timeout = U.defVal(timeout, CONF.timeouts.uiAction); var errMsg = `${this.name} (${this.selector}) still exists after ${timeout} ms`; return this._page.getDriver().waitUntil(async () =&gt; { return !(await this.isExist()); }, timeout, errMsg); }; /** * Defines whether control is visible or no. * * @method * @return {Promise.&lt;boolean&gt;} - `true` if control is visible, `false` otherwise */ Element.prototype.isVisible = function () { return this.isExist().then(result =&gt; { if (!result) return false; return this._page.getDriver().isVisible(this.selector); }); }; /** * Waits for control is visible. * * @method * @arg {number} [timeout] - timeout to wait, ms * @return {Promise.&lt;*&gt;} - result of selenium execution * @throws {TimeoutError} - If control isn't visible after timeout. */ Element.prototype.waitForVisible = function (timeout) { var timeout = U.defVal(timeout, CONF.timeouts.uiAction); var errMsg = `${this.name} (${this.selector}) isn't visible ` + `after ${timeout} ms`; return this._page.getDriver().waitUntil(async () =&gt; { return await this.isVisible(); }, timeout, errMsg); }; /** * Waits for control is invisible. * * @method * @arg {number} [timeout] - timeout to wait, ms * @return {Promise.&lt;*&gt;} - result of selenium execution * @throws {TimeoutError} - If control is still visible after timeout. */ Element.prototype.waitForInvisible = function (timeout) { var timeout = U.defVal(timeout, CONF.timeouts.uiAction); var errMsg = this.name + &quot; is still visible after &quot; + timeout + &quot; ms&quot;; return this._page.getDriver().waitUntil(async () =&gt; { return !(await this.isVisible()); }, timeout, errMsg); }; × Search results Close "},"page_event.js.html":{"id":"page_event.js.html","title":"Source: page/event.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: page/event.js &quot;use strict&quot;; /** * Browser events. * * @module */ var weak = require(&quot;weak&quot;); /** * Creates a new pointer events instance. * * @class * @classdesc Contains browser pointer events. */ var PointerEvents = module.exports.PointerEvents = function (selector, page) { this.selector = selector; this._page = weak(page); this._elCmd = `document.querySelector(&quot;${this._selector}&quot;)`; }; /** * Moves pointer over element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.over = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent('pointerover', \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Enters pointer to element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.enter = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent('pointerenter', \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Presses pointer down on element by selector. * * @arg {string} selector - css selector * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.down = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent(&quot;pointerdown&quot;, \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Unpresses pointer up on element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.up = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent(&quot;pointerup&quot;, \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Moves pointer to element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.move = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent(&quot;pointermove&quot;, \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Cancel pointer on element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.cancel = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent('pointercancel', \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Moves out pointer from element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.out = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent('pointerout', \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; /** * Leaves pointer from element by selector. * * @method * @arg {number} x - `x` coordinate * @arg {number} y - `y` coordinate * @return {Promise} */ PointerEvents.prototype.leave = function (x, y) { var cmd = ` \\ var el = ${this._elCmd}; \\ var ev = new PointerEvent('pointerleave', \\ { clientX: ${x}, clientY: ${y}, \\ bubbles: true, cancelable: true, view: window }); \\ el.dispatchEvent(ev);`; return this._page.getDriver().execute(cmd); }; × Search results Close "},"reporter_index.js.html":{"id":"reporter_index.js.html","title":"Source: reporter/index.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: reporter/index.js &quot;use strict&quot;; /** * GlaceJS reporter package. * * @module */ var CONF = require(&quot;../config&quot;); var base = require(&quot;./base&quot;); var stdout = require(&quot;./stdout&quot;); var testrail = require(&quot;./testrail&quot;); base.register(stdout); if (CONF.toTestrail) base.register(testrail); module.exports = base; × Search results Close "},"reporter_stdout.js.html":{"id":"reporter_stdout.js.html","title":"Source: reporter/stdout.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: reporter/stdout.js &quot;use strict&quot;; /** * `GlaceJS` stdout reporter. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var util = require(&quot;util&quot;); var colors = require(&quot;colors&quot;); var MochaReporter = require(&quot;mocha&quot;).reporters.base; var CONF = require(&quot;../config&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; var sessionErrors = []; var indents = 0; var indent = () =&gt; Array(indents).join(&quot; &quot;); var report = fs.createWriteStream( path.resolve(process.cwd(), &quot;report.log&quot;), { flags : &quot;w&quot; }); var stdout = function() { report.write(util.format.apply(util, arguments) + &quot;\\n&quot;); console.log.apply(console, arguments); }; var epilogue = () =&gt; { var indent = &quot; &quot;; var passedTests = []; var failedTests = []; for (var testCase of CONF.testCases) { if (testCase.status === TestCase.FAILED) { failedTests.push(testCase); }; if (testCase.status === TestCase.PASSED) { passedTests.push(testCase); }; }; if (passedTests.length !== 0) { var msg = &quot;passed test&quot; + (passedTests.length === 1 ? &quot;&quot; : &quot;s&quot;); stdout((indent + MochaReporter.symbols.ok + &quot; &quot; + String(passedTests.length).bold + &quot; &quot; + msg).green); }; if (failedTests.length !== 0) { var msg = &quot;failed test&quot; + (failedTests.length === 1 ? &quot;&quot; : &quot;s&quot;); stdout((indent + MochaReporter.symbols.err + &quot; &quot; + String(failedTests.length).bold + &quot; &quot; + msg).red); }; if (failedTests.length) { stdout(); stdout(&quot;TEST FAILURES:&quot;.bold) for (var testCase of failedTests) { stdout(); stdout((&quot;test: &quot; + testCase.name).cyan.bold); for(var err of testCase.errors) { stdout(); stdout(err.red.bold); }; }; }; if (sessionErrors.length) { stdout(); stdout(&quot;OUTTEST FAILURES:&quot;.bold); for (var error of sessionErrors) { stdout(); stdout(error.red.bold); }; }; }; var stdoutReporter = module.exports = { /** * Called before tests end. * * @method * @instance */ end: () =&gt; { epilogue(); stdout(); var reportMsg = &quot;Local report is &quot; + CONF.reportsDir; stdout(Array(reportMsg.length + 1).join(&quot;-&quot;).yellow); stdout(reportMsg.yellow); }, /** * Called on scope start. * * @method * @instance * @arg {object} scope - `MochaJS` suite. */ scope: scope =&gt; { ++indents; if (indents !== 1) { stdout(); stdout((indent() + &quot;scope: &quot; + scope.title).cyan); }; }, /** * Called before scope end. * * @method * @instance * @arg {object} scope - `MochaJS` suite. */ scopeEnd: scope =&gt; { --indents; if (indents === 1) stdout(); }, /** * Called on test start. * * @method * @instance * @arg {object} test - `MochaJS` suite. */ test: test =&gt; { ++indents; stdout(); stdout((indent() + &quot;test: &quot; + test.title).cyan.bold); }, /** * Called on test end. * * @method * @instance * @arg {object} test - `MochaJS` suite. */ testEnd: test =&gt; { --indents; if (indents === 1) stdout(); }, /** * Called on chunk passed. * * @method * @instance * @arg {object} chunk - `MochaJS` test. */ pass: chunk =&gt; { var msg = indent() + &quot; &quot; + MochaReporter.symbols.ok + &quot; chunk&quot;; if (chunk.title) msg += &quot;: &quot; + chunk.title; stdout(msg.green); }, /** * Called on chunk or hook failed. * * @method * @instance * @arg {object} chunk - `MochaJS` test. */ fail: (chunk, err) =&gt; { if (!CONF.curTestCase) { var errMsg = chunk.title; if (err.message) { errMsg += &quot;\\nmessage: &quot; + err.message; }; if (err.stack) { errMsg += &quot;\\nstack: &quot; + err.stack; }; if (err.seleniumStack) { errMsg += &quot;\\nselenium: &quot; + JSON.stringify(err.seleniumStack, null, &quot;\\t&quot;); }; sessionErrors.push(errMsg); }; var msg = indent() + &quot; &quot; + MochaReporter.symbols.err + &quot; chunk&quot;; if (chunk.title) msg += &quot;: &quot; + chunk.title; stdout(msg.red); }, /** * Called on report finalizing. * * @method * @instance */ done: () =&gt; new Promise(resolve =&gt; report.end(resolve)), }; × Search results Close "},"reporter_testrail.js.html":{"id":"reporter_testrail.js.html","title":"Source: reporter/testrail.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: reporter/testrail.js &quot;use strict&quot;; /** * TestRail reporter. * * @module */ var _ = require(&quot;lodash&quot;); var Testrail = require('testrail-api'); var CONF = require(&quot;../config&quot;); var TestCase = require(&quot;../testing&quot;).TestCase; var testrail = new Testrail({ host: CONF.testrail.host, user: CONF.testrail.user, password: CONF.testrail.token }); var Results = { PASSED: 1, BLOCKED: 2, UNTESTED: 3, RETEST: 4, FAILED: 5 }; var cases = {}; var report = Promise.resolve(); var testrailReporter = module.exports = { /** * Called on tests start. * * @method * @instance */ start: () =&gt; { report = report.then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.getCases( CONF.testrail.project, { suite_id: CONF.testrail.suiteId }, (err, _cases) =&gt; { if (err) reject(err); for (var _case of _cases) { if (cases[_case.title]) { reject(`Detect duplicated cases with name \\ '${_case.title}'. Only unique names \\ should be.`); }; cases[_case.title] = { id: _case.id }; }; resolve(); }); }); }).then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.addRun( CONF.testrail.project, { suite_id: CONF.testrail.suiteId, name: CONF.testrail.suiteName, description: description }, (err, run) =&gt; { if (err) reject(err); CONF.testrail.runId = run.id; resolve(); }); }); }); }, /** * Called before tests end. * * @method * @instance */ end: () =&gt; { console.log(); var reportMsg = &quot;TestRail report is &quot; + CONF.testrail.reportUrl + CONF.testrail.runId; console.log(Array(reportMsg.length + 1).join(&quot;-&quot;).yellow); console.log(reportMsg.yellow); }, /** * Called on test end. * * @method * @instance * @arg {object} test - `MochaJS` suite. */ testEnd: test =&gt; { var testCase = CONF.testCases.filter(t =&gt; t.name === test.title)[0]; var testrailCase = cases[test.title]; if (!testrailCase) return; var testResult = { status_id: Results.PASSED, comment: &quot;&quot; }; if (testCase.screenshots.length) { testResult.comment += &quot;\\n&quot;; for (var screen of testCase.screenshots) { testResult.comment += &quot;\\n&quot; + screen; }; }; if (testCase.videos.length) { testResult.comment += &quot;\\n&quot;; for (var video of testCase.videos) { testResult.comment += &quot;\\n&quot; + video; }; }; if (testCase.status === TestCase.FAILED) { testResult.status_id = Results.FAILED; testResult.comment += &quot;\\n&quot;; for (var error of testCase.errors) { testResult.comment += &quot;\\n&quot; + error; }; }; report = report.then(() =&gt; { return new Promise((resolve, reject) =&gt; { testrail.addResultForCase( CONF.testrail.runId, testrailCase.id, testResult, (err, res) =&gt; { if (err) reject(err); resolve(res); }); }); }); }, /** * Called on report finalizing. * * @method * @instance */ done: () =&gt; { return report; }, }; × Search results Close "},"runner.js.html":{"id":"runner.js.html","title":"Source: runner.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: runner.js &quot;use strict&quot;; /** * Makes tests root session. * * - runner loads root `conftest.js` if it is located on one level with * each of `CONF.testDirs`; * - if each of `CONF.testDirs` is file with tests, runner loads and executes it; * - if each of `CONF.testDirs` is folder runner loads files inside recursive if * file name starts with `test` and ends with `.js`; * - inside each subfolder of each of `CONF.testDirs` runner loads `conftest.js` * file if it is present; * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;) var expect = require(&quot;chai&quot;).expect; require(&quot;./globals&quot;); var ConfigError = require(&quot;./error&quot;).ConfigError; /* Loads root conftest */ if (CONF.rootConftest) { var rootConftest = path.resolve(CONF.rootConftest); expect(fs.existsSync(rootConftest) &amp;&amp; fs.statSync(rootConftest).isFile(), `Root conftest '${rootConftest}' isn't a file or doesn't exist`) .to.be.true; require(rootConftest); }; /* Checks test dirs and load sibling conftests */ for (var testDir of CONF.testDirs) { if (!fs.existsSync(testDir)) { throw new ConfigError( `File or folder with tests &quot;${testDir}&quot; doesn't exist`); }; var siblingConftest = path.resolve(path.dirname(testDir), &quot;conftest.js&quot;); if (fs.existsSync(siblingConftest)) require(siblingConftest); }; /* Starts session */ session(() =&gt; { for (var testDir of CONF.testDirs) { if (!fs.statSync(testDir).isDirectory()) { require(testDir); continue; }; var loadTests = dir =&gt; { for (var fileName of fs.readdirSync(dir)) { var filePath = path.resolve(dir, fileName); if (fileName === &quot;conftest.js&quot;) require(filePath); if (fileName.startsWith(&quot;test&quot;) &amp;&amp; fileName.endsWith(&quot;.js&quot;)) { require(filePath); }; if (fs.lstatSync(filePath).isDirectory()) { loadTests(filePath); }; }; }; loadTests(testDir); }; }); × Search results Close "},"steps_image.js.html":{"id":"steps_image.js.html","title":"Source: steps/image.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/image.js &quot;use strict&quot;; /** * Steps for screenshots and images. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var imageDiff = require(&quot;image-diff&quot;); var sharp = require(&quot;sharp&quot;); var uuid = require(&quot;uuid/v4&quot;); var U = require(&quot;glacejs-utils&quot;); var image = require(&quot;../image&quot;); sharp.cache(false); /** * Steps to manage web screenshots and images. * * @mixin ImageSteps */ module.exports = { /** * Step to make web screenshot in browser. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {string} [opts.imageName] - Screenshot name. File extension * `.png` will be added automatically. Default value is dynamically * generated on each call with algorithm `uuid`. * @arg {string} [opts.imageDirPath] - Screenshot folder path. * @arg {boolean} [opts.bySelenium=true] - Flag to use selenium to make * screenshot. Other library `html2canvas` will be used. * @arg {?string} [opts.cssSelector=null] - CSS selector of DOM element * which of screenshot should be made. * @arg {?function} [opts.preHook=null] - Function which will be called * in `Steps` context in the beginning of step. * @arg {?function} [opts.postHook=null] - Function which will be called * in `Steps` context at the end of step. * @arg {?string} [opts.element=null] - Web element name which should be * screenshotted. * @arg {boolean} [opts.check=true] - Flag to check screenshot is saved * or no. * @return {Promise&lt;string&gt;} - Path to saved screenshot. * @throws {AssertionError} - If screenshot isn't saved. */ makeScreenshot: async function (opts) { opts = U.defVal(opts, {}); var imageName = U.defVal(opts.imageName, uuid()); imageName = _.kebabCase(imageName); if (!imageName.endsWith(&quot;.png&quot;)) imageName += &quot;.png&quot;; var imagePath = U.mkpath( U.defVal(opts.imageDirPath, getScreensDir()), imageName); var bySelenium = U.defVal(opts.bySelenium, true); var cssSelector = U.defVal(opts.cssSelector); var preHook = U.defVal(opts.preHook); var postHook = U.defVal(opts.postHook); var element = U.defVal(opts.element); var check = U.defVal(opts.check, true); if (preHook) await preHook.call(this); if (bySelenium) { await this._seleniumScreenshot(imagePath); } else { await this._canvasScreenshot( imagePath, { cssSelector: cssSelector }); }; if (element) { await this._cutElement(imagePath, element, { path: imagePath }); }; if (check) { expect(fs.existsSync(imagePath), `Screenshot isn't saved to '${imagePath}'`).to.be.true; expect(await image(imagePath).isTransparent(), `Screenshot '${imagePath}' has empty content`).to.be.false; }; if (postHook) await postHook.call(this); CONF.curTestCase.addScreenshot(imagePath); return imagePath; }, /** * Step to check two image are equal or not equal * * @async * @method * @instance * @arg {string} actualImage - Path to actual image. * @arg {string} expectedImage - Path to expected image. * @arg {object} [opts] - Helper options. * @arg {number} [opts.threshold=0.05] - Threshold of divergence. * @arg {boolean} [opts.shouldBe=true] - Flag to check whether * image are equal or not equal. * @arg {string[]} [opts.elements=[]] - List of elements on image which * should be verified. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If result of images comparison don't pass * requested parameters. */ checkImagesEquivalence: async function (actualImage, expectedImage, opts) { opts = U.defVal(opts, {}); var elements = U.defVal(opts.elements, []); await this._checkImagesEquivalence(actualImage, expectedImage, opts); for (var element of elements) { var actualElImage = await this._cutElement( actualImage, element, { name: `actual ${element}` }); var expectedElImage = await this._cutElement( expectedImage, element, { name: `expected ${element}` }); await this._checkImagesEquivalence( actualElImage, expectedElImage, opts); }; }, /** * Step to check one image includes or doesn't include another image. * * @async * @method * @instance * @arg {string} fullImage - Path to image which may include. * @arg {string} includedImage - Path to image which may be included. * @arg {object} [opts] - Step options. * @arg {object} [opts.matchedDirPath] - Folder path to save matched image. * @arg {number} [opts.threshold=0.05] - Threshold of divergence. * @arg {boolean} [opts.shouldBe=true] - Flag to check whether * image are equal or not equal. * @return {Promise&lt;void&gt;} */ checkImageInclusion: async function (fullImage, includedImage, opts) { opts = U.defVal(opts, {}); var threshold = U.defVal(opts.threshold, 0.05); var shouldBe = U.defVal(opts.shouldBe, true); var matchedImagePath = U.mkpath( U.defVal( opts.matchedDirPath, path.resolve(getScreensDir(), &quot;inclusions&quot;)), uuid() + &quot;.png&quot;); var errMsg = &quot;Image &quot; + fullImage + &quot; doesn't contain image &quot; + includedImage; var result = await image(fullImage) .includes(includedImage, { tolerance: threshold, matchedPath: matchedImagePath }); if (shouldBe) { expect(result.isIncluded, `Image ${fullImage} doesn't include ${includedImage}`) .be.true; } else { expect(result.isIncluded, `Image ${fullImage} includes image ${includedImage}`) .be.false; }; }, /** * Step to check or make web screenshot in browser. * * @async * @method * @instance * @arg {string} imageName - Screenshot name. File extension * `.png` will be added automatically. * @arg {object} [opts] - Step options. * @arg {string} [opts.imageDirPath] - Screenshot folder path. * @arg {string} [opts.expectedDirPath] - Expected screenshot path. * @arg {boolean} [opts.bySelenium=true] - Flag to use selenium to make * screenshot. Other library `html2canvas` will be used. * @arg {?function} [opts.preHook=null] - Function which will be called * in `Steps` context in the beginning of step. * @arg {?function} [opts.postHook=null] - Function which will be called * in `Steps` context at the end of step. * @arg {string[]} [opts.elements=[]] - List of elements on image which * should be verified. * @arg {boolean} [opts.check=true] - Flag to check screenshot is saved * or no. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If screenshot isn't saved. */ checkOrMakeScreenshot: async function (imageName, opts) { imageName = _.kebabCase(imageName); opts = U.defVal(opts, {}); opts.imageName = imageName; var actualImage = await this.makeScreenshot(opts); if (CONF.compareImages) { testName = CONF.curTestCase ? _.kebabCase(CONF.curTestCase.name) : &quot;&quot;; var expectedImage = path.resolve( U.defVal( opts.expectedDirPath, path.resolve(CONF.resourcesDir, testName, &quot;screenshots&quot;)), imageName + &quot;.png&quot;); await this.checkImagesEquivalence( actualImage, expectedImage, opts); }; }, /** * Helper to check two images are equal or not equal. * * @async * @method * @protected * @instance * @arg {string} actualImage - Path to actual image. * @arg {string} expectedImage - Path to expected image. * @arg {object} [opts] - Helper options. * @arg {string} [opts.diffDirPath] - Path to diffs folder. * @arg {number} [opts.threshold=0.05] - Threshold of divergence. * @arg {boolean} [opts.shouldBe=true] - Flag to check whether * image are equal or not equal. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If actual image doesn't exist. * @throws {AssertionError} - If expected image doesn't exist. * @throws {AssertionError} - If result of images comparison don't pass * requested parameters. */ _checkImagesEquivalence: async function (actualImage, expectedImage, opts) { expect(fs.existsSync(actualImage), `Actual image '${actualImage}' doesn't exist`) .to.be.true; expect(fs.existsSync(expectedImage), `Expected image '${expectedImage}' doesn't exist`) .to.be.true; opts = U.defVal(opts, {}); var threshold = U.defVal(opts.threshold, 0.05); var shouldBe = U.defVal(opts.shouldBe, true); var diffImage = U.mkpath( U.defVal( opts.diffDirPath, path.resolve(getScreensDir(), &quot;diffs&quot;)), uuid() + &quot;.png&quot;); var percentage = (await new Promise((resolve, reject) =&gt; { imageDiff.getFullResult({ actualImage: actualImage, expectedImage: expectedImage, diffImage: diffImage }, function(err, result) { if (err) reject(err); resolve(result); }); })).percentage; if (shouldBe) { expect(percentage, &quot;Images are not equal&quot;).be.lte(threshold); } else { expect(percentage, &quot;Images are equal&quot;).be.gte(threshold); }; }, /** * Helper to make screenshot with selenium. * * @async * @method * @protected * @instance * @arg {string} imagePath - Path to screenshot which will be saved, * @return {Promise&lt;void&gt;} */ _seleniumScreenshot: async function (imagePath) { await this._webdriver.saveScreenshot(imagePath); }, /** * Helper to make screenshot with html2canvas. * * @async * @method * @protected * @instance * @arg {string} imagePath - Path to screenshot which will be saved. * @arg {object} [opts] - Helper options. * @arg {?string} [opts.cssSelector=null] - CSS selector of DOM element * which of screenshot should be made. * @arg {number} [opts.timeout=30000] - Time to wait for screenshot is * rendered, ms * @return {Promise&lt;void&gt;} * @throws {Error} - If screenshot will not be rendered during timeout. */ _canvasScreenshot: async function (imagePath, opts) { opts = U.defVal(opts, {}); var cssSelector = U.defVal(opts.cssSelector); var timeout = U.defVal(opts.timeout, 30000); var errMsg = &quot;Can't make screenshot&quot;; if (cssSelector) errMsg += &quot; of element with selector &quot; + cssSelector; await this._webdriver.execute(function (cssSelector) { function makeScreenshot () { if (cssSelector) { var element = document.querySelector(cssSelector); } else { var element = document.body; }; html2canvas( element, { onrendered: function(canvas) { window.__screenshot = canvas .toDataURL() .split(&quot;data:image/png;base64,&quot;)[1]; }, useCORS: true // capture images from another domains }); }; if (typeof(html2canvas) !== &quot;undefined&quot;) { makeScreenshot(); return; }; var script = document.createElement(&quot;script&quot;); script.onload = makeScreenshot; script.src = &quot;https://cdnjs.cloudflare.com&quot; + &quot;/ajax/libs/html2canvas/&quot; + &quot;0.5.0-beta4/html2canvas.min.js&quot;; document.body.appendChild(script); }, cssSelector); var screenBase64 = await this._webdriver.waitUntil(async () =&gt; { return (await this._webdriver.execute(function () { if (window.__screenshot) { var result = window.__screenshot; delete window.__screenshot; return result; } else { return false; }; })).value; }, timeout, errMsg); fs.writeFileSync(imagePath, screenBase64, &quot;base64&quot;); }, /** * Helper to cut element from image. * * @async * @method * @protected * @instance * @arg {string} imagePath - Path to image which element will be cut from. * @arg {string} elementName - Name of element which will be cut. * @arg {object} [opts] - Helper options. * @arg {string} [opts.name] - Name of cut image with element. * @arg {string} [opts.cutDirPath] - Folder path to cut elements. * @return {Promise&lt;string&gt;} - Path to cut element image. * @throws {AssertionError} - If original image doesn't exist. * @throws {AssertionError} - If DOM element is not registered in config. * @throws {AssertionError} - If cut image is not saved. */ _cutElement: async function (imagePath, elementName, opts) { expect(fs.existsSync(imagePath), `Image ${imagePath} doesn't exist`).be.true; var element = (await this.getCurrentPage())[elementName]; expect(element, `Undefined DOM element ${elementName}`).to.exist; opts = U.defVal(opts, {}); var targetName = U.defVal(opts.name, uuid()) + &quot;.png&quot;; targetPath = U.mkpath( U.defVal( opts.cutDirPath, path.resolve(getScreensDir(), &quot;cutElements&quot;)), targetName); var imageInfo = await new Promise((resolve, reject) =&gt; { sharp(imagePath).toBuffer((err, outputBuffer, info) =&gt; { if (err) reject(err); resolve(info); }); }); var eLoc = await element.location(); if (eLoc.x &lt; 0) eLoc.x = 0; if (eLoc.y &lt; 0) eLoc.y = 0; if ((eLoc.x + eLoc.width) &gt; imageInfo.width) { eLoc.width = imageInfo.width - eLoc.x; }; if ((eLoc.y + eLoc.height) &gt; imageInfo.height) { eLoc.height = imageInfo.height - eLoc.y; }; if (imagePath === targetPath) { fs.renameSync(imagePath, imagePath + &quot;.tmp&quot;); imagePath += &quot;.tmp&quot;; }; await new Promise((resolve, reject) =&gt; { sharp(imagePath) .extract({ left: eLoc.x, top: eLoc.y, width: eLoc.width, height: eLoc.height }) .crop(sharp.strategy.entropy) .toFile(targetPath, err =&gt; { if (err) reject(err); resolve(); }); }); expect(fs.existsSync(targetPath, `Image ${targetPath} isn't saved`)).be.true; if (imagePath.endsWith(&quot;.tmp&quot;)) fs.unlinkSync(imagePath); return targetPath; }, }; /** * Helper to get screenshots folder. * * @function */ var getScreensDir = () =&gt; { var testName = CONF.curTestCase ? _.kebabCase(CONF.curTestCase.name) : &quot;&quot;; return path.resolve(CONF.reportsDir, testName, &quot;screenshots&quot;); }; × Search results Close "},"steps_page.js.html":{"id":"steps_page.js.html","title":"Source: steps/page.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/page.js &quot;use strict&quot;; /** * Steps for page. * * @module */ var url = require(&quot;url&quot;); var LOG = require(&quot;glacejs-utils&quot;).logger; var StepError = require(&quot;../error&quot;).StepError; /** * Steps to manage page. * * @mixin PageSteps */ module.exports = { /** * Helper to register pages. * * @method * @instance * @arg {...Page} pages - Sequence of pages. */ registerPages: function () { for (var page of arguments) { if (this._pages()[page.name]) { LOG.debug(`Page ${page.name} is registered already`); continue; }; page.setDriver(this._webdriver); this._pages()[page.name] = page; }; }, /** * Helper to remove pages. * * @method * @instance * @arg {...string} pageNames - Sequence of page names. */ removePages: function () { for (var pageName of arguments) { if (!this._pages()[pageName]) { LOG.debug(`Page ${pageName} isn't registered`); continue; }; this._pages()[pageName].setDriver(null); delete this._pages()[pageName]; }; }, /** * Step to open page. * * @method * @instance * @async * @arg {string} pageName - Name of page to open. */ openPage: async function (pageName) { var page = this._pages()[pageName]; var webUrl = url.resolve(this._appUrl, page.url); await this.openUrl(webUrl); }, /** * Step to get current page. * * @async * @method * @instance * @return {Promise&lt;Page&gt;} - Page which corresponds to current browser URL. * @throws {StepError} - If no one of registered pages corresponds to * current browser URL. */ getCurrentPage: async function () { /* sort pages by descending page url length */ var pages = Object.values(this._pages()).sort( (a, b) =&gt; a.url.length &lt; b.url.length); var curUrl = url.parse(await this._webdriver.getUrl()); for (var page of pages) { if (curUrl.pathname.startsWith(page.url)) return page; }; throw new StepError( &quot;No one of registered pages corresponds URL '${curUrl}'&quot;); }, /** * Helper to initialize pages storage. * * @method * @protected */ _pages: function () { if (!this.__pages) this.__pages = []; return this.__pages; }, }; × Search results Close "},"steps_timer.js.html":{"id":"steps_timer.js.html","title":"Source: steps/timer.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/timer.js &quot;use strict&quot;; /** * Time steps. * * @module */ /** * Steps to measure time. * * @mixin TimerSteps */ module.exports = { /** * Step to start timer. * * @method * @instance */ startTimer: function () { this._timer = new Date; }, /** * Step to stop timer. * * @method * @instance */ stopTimer: function () { this._timer = null; }, /** * Step to check timer. * * @method * @instance * @arg {string|object} condition - chaijs condition. * @throws {AssertionError} - If timer verification is failed. */ checkTimer: function (condition) { expect(this._timer, &quot;Timer isn't started&quot;).to.exist; var diff = (new Date - this._timer) / 1000; expect(diff, &quot;Timing is failed&quot;).to.correspond(condition); }, }; × Search results Close "},"steps_video.js.html":{"id":"steps_video.js.html","title":"Source: steps/video.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/video.js &quot;use strict&quot;; /** * Steps for video recording. * * @module */ var fs = require(&quot;fs&quot;); var path = require(&quot;path&quot;); var _ = require(&quot;lodash&quot;); var resolution = require(&quot;screen-resolution&quot;); var uuid = require(&quot;uuid/v4&quot;); var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; var VideoRecorder = require(&quot;../video&quot;); /** * Steps to manage video recording. * * @mixin VideoSteps */ module.exports = { /** * Step to start video recording. Step recall will be skipped if video * recording wasn't stopped before. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {string} [opts.name] - File name. Extension `.avi` will be * added automatically. Default name will be generated with `uuid` * algorithm. * @arg {string} [opts.path] - Folder to save video. * @arg {boolean} [opts.check=true] - Flag to check that video recording * was launched. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If video recording wasn't launched. */ startVideo: async function (opts) { if (this._isVideoStarted) { LOG.warn(&quot;Step to start video recording was passed already&quot;); return false; }; opts = U.defVal(opts, {}); var fileName = U.defVal(opts.name, uuid()) + &quot;.avi&quot;; var check = U.defVal(opts.check, true); if (!this._video) this._video = new VideoRecorder(); var videoOpts = {}; var screen = await resolution.get(); if (await this._webdriver.session()) { _.assign(videoOpts, (await this._webdriver.windowHandlePosition()).value); _.assign(videoOpts, (await this._webdriver.windowHandleSize()).value); if (videoOpts.x &lt; 0) videoOpts.x = 0; if (videoOpts.y &lt; 0) videoOpts.y = 0; if (videoOpts.x + videoOpts.width &gt; screen.width) { videoOpts.width = screen.width - videoOpts.x; }; if (videoOpts.y + videoOpts.height &gt; screen.height) { videoOpts.height = screen.height - videoOpts.y; }; } else { videoOpts = { x: 0, y: 0, width: screen.width, height: screen.height }; }; var testName = CONF.curTestCase ? _.kebabCase(CONF.curTestCase.name) : &quot;&quot;; videoOpts.path = U.mkpath( U.defVal(opts.path, path.resolve(CONF.reportsDir, testName, &quot;videos&quot;)), fileName); this._video.configure(videoOpts); this._video.start(); await this.pause(1, &quot;it needs a time to start recording&quot;); if (check) { expect(this._video.isRunning, &quot;Video recording wasn't launched&quot;) .to.be.true; }; this._isVideoStarted = true; return true; }, /** * Step to stop video recording. Step call will be skipped if video * recording wasn't launched before. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check that video recording * was stopped. * @return {Promise&lt;string&gt;} - Path to recorded video. * @throws {AssertionError} - If video recording wasn't stopped. */ stopVideo: async function (opts) { if (!this._isVideoStarted) { LOG.warn(&quot;Step to start video recording wasn't passed yet&quot;); return false; }; opts = U.defVal(opts, {}); var check = U.defVal(opts.check, true); await this.pause(1, &quot;it needs a time to gather latest frames&quot;); await this._video.stop(); if (check) { expect(this._video.isRunning, &quot;Video recording was still running&quot;) .to.be.false; }; this._isVideoStarted = false; return this._video.filePath; }, /** * Step to get path to recorded video. * * @method * @instance * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check that video is recorded * and path exists. * @return {string} - Path to recorded video. */ getVideo: function (opts) { expect(this._video, &quot;Video recorder isn't initialized&quot;).to.exist; opts = U.defVal(opts, {}); var check = U.defVal(opts.check, true); if (check) { expect(this._video.isRunning, &quot;Can't get recorded video file path, &quot; + &quot;because video is still recording&quot;).to.be.false; expect(this._video.filePath, &quot;Can't get recorded video file path, &quot; + &quot;because it's empty&quot;).to.not.be.empty; }; return this._video.filePath; }, /** * Step to remove recorded video. * * @method * @instance * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check step result. * @throws {AssertionError} - If video file wasn't removed. */ removeVideo: function (opts) { if (!this._video.filePath || !fs.existsSync(this._video.filePath)) { LOG.warn(&quot;Video file doesn't exist&quot;); return false; }; opts = U.defVal(opts, {}); var check = U.defVal(opts.check, true); fs.unlinkSync(this._video.filePath); if (check) { expect(fs.existsSync(this._video.filePath), `Video file '${this._video.filePath}' wasn't removed`) .to.be.false; }; return true; }, }; × Search results Close "},"steps_web.js.html":{"id":"steps_web.js.html","title":"Source: steps/web.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/web.js &quot;use strict&quot;; /** * Steps for web applications. * * @module */ var selenium = require(&quot;selenium-standalone&quot;); var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; /** * Steps to manage web application. * * @mixin WebSteps */ module.exports = { /** * Step to install selenium drivers. * * @async * @method * @instance * @return {Promise&lt;void&gt;} * @throws {Error} - If there was error during drivers installation. */ installSeleniumDrivers: async function () { var opts = { logger: LOG.debug.bind(LOG), }; await new Promise((resolve, reject) =&gt; { selenium.install(opts, err =&gt; { if (err) reject(err); LOG.debug(&quot;Selenium drivers are installed&quot;); resolve(); }); }); }, /** * Step to start selenium server. Step recall will be skipped if * selenium server wasn't stopped before. * * @async * @method * @instance * @return {Promise&lt;void&gt;} * @throws {Error} - If there was error on selenium start. */ startSeleniumServer: async function () { if (this._seleniumProc) { LOG.warn(&quot;Step to start selenium server was passed already&quot;); return false; }; var opts = {}; this._seleniumProc = await new Promise((resolve, reject) =&gt; { selenium.start(opts, (err, child) =&gt; { if (err) reject(err); LOG.debug( `Selenium server starts with PID ${child.pid}`); resolve(child); }) }); return true; }, /** * Step to stop selenium server. Step call will be skipped if selenium * server wasn't started before. * * @async * @method * @instance * @return {Promise&lt;void&gt;} * @throws {Error} - If there was error on selenium stop. */ stopSeleniumServer: async function () { if (!this._seleniumProc) { LOG.warn(&quot;Step to start selenium server wasn't passed yet&quot;); return false; }; await new Promise((resolve, reject) =&gt; { this._seleniumProc.on(&quot;exit&quot;, (code, signal) =&gt; { LOG.debug(`Selenium server was stopped with`, `code ${code} and signal ${signal}`); delete this._seleniumProc; resolve(); }); this._seleniumProc.on(&quot;error&quot;, reject); var result = this._seleniumProc.kill(&quot;SIGINT&quot;); if (!result) reject(&quot;Oops! Can't kill selenium server&quot;); }); return true; }, /** * Step to launch browser. Step recall will be skipped if browser * wasn't closed before. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check that browser was * launched. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If browser wasn't launched. */ launchBrowser: async function (opts) { if (this._isBrowserLaunched) { LOG.debug(&quot;Step to launch browser was passed already&quot;); return false; }; opts = U.defVal(opts, {}); var check = U.defVal(opts.check, true); var proxyOptions = [ &quot;ignore-certificate-errors&quot;, `proxy-server=${U.hostname}:${CONF.proxy.globalPort}`, `proxy-bypass-list=localhost,127.0.0.1,${U.hostname}` ]; var chromeArgs = this._webdriver.desiredCapabilities.chromeOptions.args; for (var option of proxyOptions) { if (this._isGlobalProxyStarted) { if (!chromeArgs.includes(option)) { chromeArgs.push(option); }; } else { if (chromeArgs.includes(option)) { var idx = chromeArgs.indexOf(option); chromeArgs.splice(idx, 1); }; }; }; await this._webdriver.init(); if (check) { expect(await this._webdriver.session(), &quot;Browser wasn't launched&quot;).to.exist; }; this._isBrowserLaunched = true; return true; }, /** * Step to close browser. Step will be skipped if browser wasn't launched * before. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check that browser was closed. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If browser wasn't closed. */ closeBrowser: async function (opts) { if (!this._isBrowserLaunched) { LOG.debug(&quot;Step to launch browser wasn't passed yet&quot;); return false; }; opts = U.defVal(opts, {}); opts.check = U.defVal(opts.check, true); await this._webdriver.end(); await this.pause(1, &quot;webdriver process will be stopped&quot;); if (opts.check) { expect(await this._webdriver.session(), &quot;Browser wasn't closed&quot;).to.not.exist; }; this._isBrowserLaunched = false; return true; }, /** * Step to restart browser. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @return {Promise&lt;void&gt;} */ restartBrowser: async function (opts) { await this.closeBrowser(opts); await this.launchBrowser(opts); }, /** * Step to open URL in browser. * * @async * @method * @instance * @arg {string} pageUrl - URL which should be opened in browser. * @arg {object} [opts] - Step options. * @arg {boolean} [opts.check=true] - Flag to check that URL is opened. * @arg {number} [opts.timeout] - Timeout to wait for URL will be opened * in browser, ms. Default value is `CONF.timeouts.pageLoad`. * @return {Promise&lt;void&gt;} * @throws {Error} - If URL wasn't opened after timeout. */ openUrl: async function (webUrl, opts) { opts = U.defVal(opts, {}); var check = U.defVal(opts.check, true); var timeout = U.defVal(opts.timeout, CONF.timeouts.pageLoad); await this._webdriver.url(webUrl); if (check) { var errMsg = `Browser didn't navigate to ${webUrl} ` + `during ${timeout} ms`; await this._webdriver.waitUntil(async () =&gt; { var curUrl = await this._webdriver.getUrl(); LOG.debug(`Compare current URL ${curUrl}`, `with expected ${webUrl}`); return curUrl.startsWith(webUrl); }, timeout, errMsg); }; }, /** * Step to open application URL in browser. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @return {Promise&lt;void&gt;} * @throws {AssertionError} - If application URL is not defined. */ openApp: async function (opts) { expect(this._appUrl, &quot;Application url isn't defined&quot;).to.exist; await this.openUrl(this._appUrl, opts); }, }; × Search results Close "},"steps_xvfb.js.html":{"id":"steps_xvfb.js.html","title":"Source: steps/xvfb.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/xvfb.js &quot;use strict&quot;; /** * Steps for virtual display. * * @module */ var LOG = require(&quot;glacejs-utils&quot;).logger; var resolution = require(&quot;screen-resolution&quot;); var Xvfb = require(&quot;xvfb&quot;); var CONF = require(&quot;../config&quot;); /** * Steps to manage virtual display. * * @mixin XvfbSteps */ module.exports = { /** * Step to start virtual display. Step recall will be skipped if virtual * display wasn't stopped before. * * @async * @method * @instance * @arg {object} [opts] - Step options. * @arg {number} [opts.width] - Virtual display width. By default * corresponds to active display. * @arg {number} [opts.height] - Virtual display height. By default * corresponds to active display. * @arg {number} [opts.depth=24] - Virtual display color depth. * @arg {number} [opts.timeout=1000] - Time to wait for virtual display * will be started, ms. * @return {Promise&lt;void&gt;} */ startXvfb: async function (opts) { if (this._isXvfbStarted) { LOG.warn(&quot;Step to start Xvfb was passed already&quot;); return false; }; if (!CONF.xvfbWidth &amp;&amp; !CONF.xvfbHeight) { var screen = await resolution.get(); }; opts = opts || {}; var width = opts.width || CONF.xvfbWidth || screen.width; var height = opts.height || CONF.xvfbHeight || screen.height; var depth = opts.depth || 24; var timeout = opts.timeout || 1000; this._xvfb = new Xvfb({ timeout: timeout, xvfb_args: [ &quot;-screen&quot;, 0, `${width}x${height}x${depth}`, &quot;-noreset&quot;, &quot;-ac&quot;] }); this._xvfb.startSync(); this._isXvfbStarted = true; return true; }, /** * Step to stop virtual display. Step call will be skipped if virtual * display wasn't started before. * * @method * @instance */ stopXvfb: function () { if (!this._isXvfbStarted) { LOG.warn(&quot;Step to start Xvfb wasn't passed yet&quot;); return false; }; this._xvfb.stopSync(); this._isXvfbStarted = false; return true; }, }; × Search results Close "},"testing.js.html":{"id":"testing.js.html","title":"Source: testing.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: testing.js &quot;use strict&quot;; /** * Contains classes and functions to save executed tests data. * * @module */ var _ = require(&quot;lodash&quot;); /** * Test case data structure. * * Contains full information and history about test case. * * @class * @arg {string} name - Test case name. */ var TestCase = module.exports.TestCase = function (name) { this.name = name; this.status = TestCase.NOT_STARTED; }; /** * Resets test case info. * * @method */ TestCase.prototype.reset = function () { this.screenshots = []; this.errors = []; this.failedParams = []; this.testParams = {}; }; /** * Adds failed params if they don't exist. * * @method * @arg {object} params - Params which test was failed with. */ TestCase.prototype.addFailedParams = function (params) { for (var failed of this.failedParams) { if (_.isEqual(params, failed)) break; }; this.failedParams.push(params); }; /** * Adds error to test case. * * @method * @arg {Error} err - Error. */ TestCase.prototype.addError = function (err) { this.errors.push(err); }; /** * Adds screenshot. * * @method * @arg {string} imagePath - Path to saved screenshot. */ TestCase.prototype.addScreenshot = function (imagePath) { this.screenshots.push(imagePath); }; TestCase.NOT_STARTED = &quot;not started&quot;; TestCase.IN_PROGRESS = &quot;in progress&quot;; TestCase.FAILED = &quot;failed&quot;; TestCase.PASSED = &quot;passed&quot;; × Search results Close "},"video.js.html":{"id":"video.js.html","title":"Source: video.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: video.js &quot;use strict&quot;; /** * Classes and functions for video recording. * * @module */ var path = require(&quot;path&quot;); var spawn = require(&quot;cross-spawn&quot;); var which = require(&quot;which&quot;); var ConfigError = require(&quot;./error&quot;).ConfigError; var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; /** * Creates a new instance of VideoRecorder. * * @class * @classdesc contains methods to record video for tests * @property {boolean} isRunning=false - flag is video recorder running or no * @property {?string} filePath=null - path video file */ var VideoRecorder = module.exports = function () { this.isRunning = false; this.filePath = null; this._process = null; this._recordOpts = null; }; /** * Configures video recorder. * * @method * @arg {object} [opts] - recorder configuration * @arg {number} [opts.fps=30] - video framerate * @arg {number} [opts.width=1024] - video width * @arg {number} [opts.height=768] - video height * @arg {number} [opts.x=0] - `X`-offset on display * @arg {number} [opts.y=0] - `Y`-offset on display */ VideoRecorder.prototype.configure = function (opts) { opts = U.defVal(opts, {}); opts.fps = U.defVal(opts.fps, 30); opts.width = U.defVal(opts.width, 1024); opts.height = U.defVal(opts.height, 768); opts.x = U.defVal(opts.x, 0); opts.y = U.defVal(opts.y, 0); opts.size = opts.width + &quot;x&quot; + opts.height; this.filePath = U.defVal(opts.path, path.resolve(__dirname, &quot;out.avi&quot;)); if (process.platform === &quot;win32&quot;) { which.sync(&quot;ffmpeg&quot;); this._recordCmd = &quot;ffmpeg&quot;; this._recordOpts = [ &quot;-y&quot;, &quot;-loglevel&quot;, &quot;quiet&quot;, &quot;-video_size&quot;, opts.size, &quot;-offset_x&quot;, opts.x, &quot;-offset_y&quot;, opts.y, &quot;-draw_mouse&quot;, 0, &quot;-framerate&quot;, opts.fps, &quot;-f&quot;, &quot;gdigrab&quot;, &quot;-i&quot;, &quot;desktop&quot;, &quot;-vcodec&quot;, &quot;libx264&quot;, this.filePath ]; } else if (process.platform === &quot;linux&quot;) { if (which.sync(&quot;avconv&quot;, { nothrow: true })) { this._recordCmd = &quot;avconv&quot;; } else if (which.sync(&quot;ffmpeg&quot;, { nothrow: true })) { this._recordCmd = &quot;ffmpeg&quot;; } else { throw new Error(&quot;not found: avconv or ffmpeg&quot;); }; this._recordOpts = [ &quot;-y&quot;, &quot;-loglevel&quot;, &quot;quiet&quot;, &quot;-f&quot;, &quot;x11grab&quot;, &quot;-r&quot;, opts.fps, &quot;-s&quot;, opts.size, &quot;-i&quot;, `${process.env.DISPLAY}+${opts.x},${opts.y}`, &quot;-codec&quot;, &quot;libx264&quot;, this.filePath ]; } else { throw new ConfigError(`Video capture isn't supported ` + `on platform '${process.platform}'`); }; }; /** * Starts video recorder. * * @method * @throws {Error} if video recorder is started already * @throws {Error} if video recorder isn't configured yet */ VideoRecorder.prototype.start = function () { if (this.isRunning) return; if (!this._recordOpts) throw new Error(&quot;Video recorder isn't configured yet&quot;); this._process = spawn(this._recordCmd, this._recordOpts, { killSignal: &quot;SIGINT&quot; }); this.isRunning = true; }; /** * Stops video recorder. * * @method * @throws {Error} if video recorder isn't started yet */ VideoRecorder.prototype.stop = function () { if (!this.isRunning) return; return new Promise((resolve, reject) =&gt; { this._process.on(&quot;exit&quot;, (code, signal) =&gt; { LOG.debug(`${this._recordCmd} was stopped with ` + `code ${code} and signal ${signal}`); this.isRunning = false; resolve(); }); this._process.on(&quot;error&quot;, reject); var result = this._process.kill(&quot;SIGINT&quot;); if (!result) reject(`Oops! Can't kill ${this._recordCmd}`); }); }; × Search results Close "},"page_index.js.html":{"id":"page_index.js.html","title":"Source: page/index.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: page/index.js &quot;use strict&quot;; /** * Page of browser. * * @class * @name Page * @arg {string} name - Name of page. * @arg {string} pageUrl - URL of page. * @arg {object} elements - Element names and selectors dictionary. */ var GlaceError = require(&quot;../error&quot;).GlaceError; var Element = require(&quot;./element&quot;); var Page = function (name, pageUrl, elements) { this.name = name; this.url = pageUrl; this._webdriver = null; this.addElements(elements || {}); }; module.exports = Page; /** * Sets webdriver for page. * * @method * @arg {object} webdriver - Webdriver instance. */ Page.prototype.setDriver = function (webdriver) { this._webdriver = webdriver; }; /** * Gets webdriver. * * @method * @return {object} - Webdriver instance. * @throws {AssertionError} - If webdriver isn't set yet. */ Page.prototype.getDriver = function () { expect(this._webdriver, &quot;Webdriver isn't set&quot;) .to.not.be.null; return this._webdriver; }; /** * Adds elements to page. * * @method * @arg {object} elements - Element names and selectors dictionary. */ Page.prototype.addElements = function (elements) { for (var name in elements) { var selector = elements[name]; if (this[name]) { throw new GlaceError( `Page '${this.name}' already contains property '${name}'`); }; this[name] = new Element(name, selector, this); }; }; /** * Removes elements from page. * * @method * @arg {...string} elementNames - Sequence of element names. */ Page.prototype.removeElements = function () { for (var name of arguments) delete this[name]; }; × Search results Close "},"run.js.html":{"id":"run.js.html","title":"Source: run.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: run.js &quot;use strict&quot;; /** * Runs tests. * * - executes `runner.js` file, which is entry point to load and execute * files with tests * - connects custom reporter to `mochajs`. * * @function * @name run * @arg {function} cb - Callback. */ var path = require(&quot;path&quot;); var Mocha = require(&quot;mocha&quot;); var CONF = require(&quot;./config&quot;); var hacking = require(&quot;./hacking&quot;); var run = cb =&gt; { if (CONF.uncaught !== &quot;mocha&quot;) hacking.suppressMochaUncaught(); var mocha = new Mocha({ grep: CONF.grep, timeout: CONF.timeouts.testCase, retries: CONF.chunkRetries, reporter: path.resolve(__dirname, &quot;reporter&quot;) }); mocha.addFile(path.resolve(__dirname, &quot;runner.js&quot;)); var _run = fin =&gt; { mocha.run(code =&gt; { var clampedCode = Math.min(code, 255); if (CONF.isRunPassed) clampedCode = 0; fin(clampedCode); }); }; if (cb) { _run(cb); } else { return new Promise(resolve =&gt; _run(resolve)); }; }; module.exports = run; × Search results Close "},"steps_index.js.html":{"id":"steps_index.js.html","title":"Source: steps/index.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Source: steps/index.js &quot;use strict&quot;; /** * Steps collection which will be executed in test cases. * * @class * @name Steps * @mixes ImageSteps * @mixes PageSteps * @mixes ProxySteps * @mixes TimerSteps * @mixes VideoSteps * @mixes WebSteps * @mixes XvfbSteps */ var _ = require(&quot;lodash&quot;); var U = require(&quot;glacejs-utils&quot;); var LOG = U.logger; var CONF = require(&quot;../config&quot;); var Steps = function () { this._config = CONF; this._appUrl = CONF.appUrl; this._webdriver = null; }; module.exports = Steps; /** * Sets webdriver. * * It's used for web ui test cases. * * @method * @arg {object} webdriver - Instance of webdriver. */ Steps.prototype.setWebdriver = function (webdriver) { this._webdriver = webdriver; }; /** * Step to make pause in another step or test case. Good style to rid of * its direct usage in test case, only inside other step. * * @method * @async * @arg {number} timeout - Pause time, sec. * @arg {string} message - Pause reason. * @return {Promise&lt;void&gt;} */ Steps.prototype.pause = async function (timeout, message) { expect(message, &quot;Pause message is not defined&quot;).to.not.be.undefined; LOG.warn(&quot;Sleep&quot;, timeout, &quot;sec, reason:&quot;, message); await U.sleep(timeout * 1000); }; /** * Registers sequence of objects containing steps. * * @method * @static */ Steps.register = function () { for (var obj of arguments) { _.assign(this.prototype, obj); }; }; Steps.register(require(&quot;./timer&quot;)); Steps.register(require(&quot;./image&quot;), require(&quot;./page&quot;), require(&quot;./video&quot;), require(&quot;./web&quot;)); Steps.register(require(&quot;./xvfb&quot;)); try { Steps.register(require(&quot;glacejs-proxy&quot;).Steps); } catch (e) { LOG.warn(&quot;GlaceJS Proxy isn't installed&quot;); }; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Global Members CONF GlaceJS config. Source: globals.js, line 53 See: config to get more details about its options. reporters :Array.&lt;object&gt; Registered reporters. Type: Array.&lt;object&gt; Source: reporter/base.js, line 23 SS Atomic steps collection. Source: globals.js, line 60 See: steps to get more details about its methods. Methods afterChunk(name, func) Executes after each test chunk. Parameters: Name Type Description name string Name of test case. func function Hook function. Source: globals.js, line 406 Example test(&quot;Some test&quot;, () =&gt; { afterChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); afterSession(ctx) Executes after tests session. May be overridden or expanded. Parameters: Name Type Description ctx object Session context. Source: globals.js, line 198 Example var oldAfterSession = afterSession; global.afterSession = ctx =&gt; { oldAfterSession(ctx); after(() =&gt; { someFunc(); }); }; beforeChunk(name, func) Executes before each test chunk. Parameters: Name Type Description name string Name of test case. func function Hook function. Source: globals.js, line 383 Example test(&quot;Some test&quot;, () =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); beforeSession(ctx) Executes before tests session. May be overridden or expanded. Parameters: Name Type Description ctx object Session context. Source: globals.js, line 177 Example var oldBeforeSession = beforeSession; global.beforeSession = ctx =&gt; { before(() =&gt; { someFunc(); }); oldBeforeSession(ctx); }; chunk( [name], func) Executes test chunk. Contains actions and verifications, which will be executed separatly from another chunks. This function is used to organize test structure and to allocate independent test actions. Parameters: Name Type Argument Description name string &lt;optional&gt; Name of test case. func function Step function. Source: globals.js, line 354 Example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); expect(actualValue) chaijs expect function. Parameters: Name Type Description actualValue * Some actual value which should be checked. Source: globals.js, line 46 See: chaijs to get more details about `expect` usage. Example expect(1).to.be.equal(1); expect(2).to.be.gte(0); fixBrowser() Fixture to launch browser. Source: fixtures.js, line 87 fixGlobalProxy() Fixture to launch http proxy. Source: fixtures.js, line 143 fixHttpProxy() Fixture to launch http proxy. Source: fixtures.js, line 123 fixSelenium() Fixture to launch selenium server. Source: fixtures.js, line 63 fixVideo() Fixture to capture tests video. Source: fixtures.js, line 15 fixWebdriver() Fixture to set webdriver. Source: fixtures.js, line 107 fixXvfb() Fixture to launch xvfb. Source: fixtures.js, line 43 forEachLanguage( [ctx] [, opts] [, fixtures], func) Iterates test chunks through all languages specifed in config. It's applicable for multilingual application. If list of languages is specified, it will be used firstly. Otherwise from configuration. Parameters: Name Type Argument Description ctx object &lt;optional&gt; Test case context. opts object &lt;optional&gt; Options. Properties Name Type Argument Default Description video boolean &lt;optional&gt; false Flag to involve video fixture. May be managed in config. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Function with test steps. Source: globals.js, line 438 Example test(&quot;Some test&quot;, ctx =&gt; { forEachLanguage(ctx, lang =&gt; { beforeChunk(() =&gt; { someFunc(); }); chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); run(cb) Runs tests. executes runner.js file, which is entry point to load and execute files with tests connects custom reporter to mochajs. Parameters: Name Type Description cb function Callback. Source: run.js, line 2 scope(name [, fixtures], func) Execute tests scope. Parameters: Name Type Argument Description name string Scope name. fixtures Array.&lt;function()&gt; &lt;optional&gt; List of fixtures. func function Function with test cases. Source: globals.js, line 86 Example scope(&quot;Some test scope&quot;, () =&gt; { test(&quot;Some test name&quot;, () =&gt; { before(() =&gt; { someFunc(); }); chunk(&quot;chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;chunk #2&quot;, () =&gt; { someFunc(); }); }); }); session( [name] [, ctx], func) Executes tests session. Parameters: Name Type Argument Description name string &lt;optional&gt; Session name. By default it includes start date time. ctx object &lt;optional&gt; Session context. By default it's empty. func function Function with test cases. Source: globals.js, line 131 Example session(() =&gt; { test(&quot;Test #1&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); test(&quot;Test #2&quot;, () =&gt; { chunk(&quot;Chunk #1&quot;, () =&gt; { someFunc(); }); chunk(&quot;Chunk #2&quot;, () =&gt; { someFunc(); }); }); }); test(name [, opts] [, fixtures], func) Executes test case. Parameters: Name Type Argument Description name string Name of test case. opts object &lt;optional&gt; Options. Properties Name Type Argument Default Description video boolean &lt;optional&gt; true Flag to involve video fixture. skip boolean &lt;optional&gt; false Flag to skip test. retry number &lt;optional&gt; 0 Number of retries on failure. May be managed in config. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Test function. Source: globals.js, line 329 Example test(&quot;Some test&quot;, () =&gt; { chunk(&quot;Some chunk&quot;, () =&gt; { someFunc(); }); }); × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Modules Classes GlaceReporter ConfigError GlaceError StepError Image Element PointerEvents TestCase VideoRecorder Page Steps Mixins ImageSteps PageSteps TimerSteps VideoSteps WebSteps XvfbSteps Namespaces GlaceConfig × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Classes Classes GlaceReporter ConfigError GlaceError StepError Image Element PointerEvents TestCase VideoRecorder Page Steps Mixins ImageSteps PageSteps TimerSteps VideoSteps WebSteps XvfbSteps Namespaces GlaceConfig × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Namespaces Classes GlaceReporter ConfigError GlaceError StepError Image Element PointerEvents TestCase VideoRecorder Page Steps Mixins ImageSteps PageSteps TimerSteps VideoSteps WebSteps XvfbSteps Namespaces GlaceConfig × Search results Close "},"mixins.list.html":{"id":"mixins.list.html","title":"Mixins","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixins Classes GlaceReporter ConfigError GlaceError StepError Image Element PointerEvents TestCase VideoRecorder Page Steps Mixins ImageSteps PageSteps TimerSteps VideoSteps WebSteps XvfbSteps Namespaces GlaceConfig × Search results Close "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Tutorials Classes GlaceReporter ConfigError GlaceError StepError Image Element PointerEvents TestCase VideoRecorder Page Steps Mixins ImageSteps PageSteps TimerSteps VideoSteps WebSteps XvfbSteps Namespaces GlaceConfig × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Glace (fr. glacé — ice, frozen) is a cold drink based on coffee with addition of ice cream. GlaceJS is a functional testing framework based on mochajs. Features Cross-platform Uses mochajs as test runner Has own tests and reports system Oriented to complex functional scenarios Supports multiple independent verifications (chunks) inside a test Supports parameterization inside and outside of test Has built-in mechanism to retry failed tests or chunks Has built-in reporters to terminal, report.log file and TestRail Launches selenium server if external selenium address isn't specified Supports STEPS architecture and Page Object Pattern Has mechanism to compare two images Has mechanism to search one image inside another image Supports video capture of executed tests Supports xvfb virtual display and video capture of it Includes two proxies: simple http proxy and global transparent proxy Supports a set of middlewares for both proxies Includes middleware to cache server responses Includes middleware to manage proxy responses speed Includes middleware to gather server responses information Supports JSON config for CLI options Supports extending default config with user config Binary software may be used java for selenium server usage; chrome browser for web tests; imagemagick (unix only) for images comparison (on windows will be installed together with framework); avconv (linux only) for video capture. On windows ffmpeg is used which will be installed together with framework. On macOS isn't implemented still; compiler for native nodejs modules. On windows may be installed with npm i -g windows-build-tools; How to installUse npm: npm i glacejsOr clone repository: git clone https://github.com/schipiga/glacejs.git cd glacejs npm iHow to launch testsIf you clone repository and install it as developer, you may find a plenty of examples with commands how to launch them. After npm installation you may use command glace to launch tests. Use glace -h to get info about available options, or read about CLI options in documentation. How to write testsPlease look through examples to see how to write tests. In documentation also you may find description of all supported steps. Bugs and feedbacksPlease fill free to create an issue on github. × Search results Close "},"GlaceReporter.html":{"id":"GlaceReporter.html","title":"Class: GlaceReporter","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: GlaceReporter GlaceReporter new GlaceReporter(runner) GlaceJS common reporter. Parameters: Name Type Description runner object MochaJS runner. Source: reporter/base.js, line 2 Methods &lt;static&gt; register(reporters) Registers reporters if they are not. Parameters: Name Type Argument Description reporters object &lt;repeatable&gt; Sequence of reporters to register. Source: reporter/base.js, line 152 &lt;static&gt; remove(reporters) Removes reporters if they are registered. Parameters: Name Type Argument Description reporters object &lt;repeatable&gt; Sequence of reporters to remove. Source: reporter/base.js, line 166 &lt;async&gt; done(failures, fn) Finalizes reporting. Parameters: Name Type Description failures Array.&lt;*&gt; Tests failures. fn function Finalizator. Source: reporter/base.js, line 134 × Search results Close "},"module-lib_cli.html":{"id":"module-lib_cli.html","title":"Module: lib/cli","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/cli Contains functions to execute tests via command line interface. Source: cli.js, line 2 Methods &lt;static&gt; run() Runs GlaceJS in CLI. Source: cli.js, line 18 × Search results Close "},"module-lib_config.html":{"id":"module-lib_config.html","title":"Module: lib/config","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/config Configures GlaceJS before tests run. Source: config.js, line 2 Namespaces GlaceConfig × Search results Close "},"module-lib_config-GlaceConfig.html":{"id":"module-lib_config-GlaceConfig.html","title":"Namespace: GlaceConfig","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Namespace: GlaceConfig lib/config~ GlaceConfig Contains GlaceJS main configuration. Properties: Name Type Argument Default Description curTestCase TestCase &lt;optional&gt; &lt;nullable&gt; null Pointer to current test case object. On tests run it points to null. The pointer changes when a test launches. testCases Array.&lt;TestCase&gt; &lt;optional&gt; [] List of all executed test cases. It populates when a test launches. It is used to store full information about executed tests and may be used in reporter. testDirs string Path to test directories or test modules. If it contains path to directory, tests will be loaded recursive from it. By default GlaceJS tries to load tests from tests folder in current work directory. reportsDir string Path to directory where reports will be put. By default GlaceJS tries to put reports to reports folder in current work directory. log object Logger settings. Properties Name Type Argument Default Description file string Path to common logger file, which is glacejs.log inside current work directory. level string &lt;optional&gt; debug Common logger level. webdriver object Webdriver settings. Corresponds to webdriverio remote settings. isWeb boolean &lt;optional&gt; false Flag to launch tests in browser. appUrl string URL of web application. noDriversInstall boolean &lt;optional&gt; true Flag to not install selenium drivers on start. platform string &lt;optional&gt; pc Platform type where should launch tests. Permitted values are pc, android, ios. browserName string Name of browser where tests will be executed. Default value depends on platform. Chrome for pc, chrome for android, safari for ios. testRetries number &lt;optional&gt; 0 Number of times to retry a failed test. stdoutLog boolean &lt;optional&gt; false Flag to print log message in stdout. toTestrail boolean &lt;optional&gt; false Flag to plug testrail reporter. grep string &lt;optional&gt; Filter for test cases. suppressUncaught boolean &lt;optional&gt; false Suppress uncaught exceptions processing by mochajs. isDesktop boolean &lt;optional&gt; false Flag that tests are launched on desktop. isMobile boolean &lt;optional&gt; false Flag that tests are launched on mobile device. isAndroid boolean &lt;optional&gt; false Flag that tests are launched on android device. isIos boolean &lt;optional&gt; false Flag that tests are launched on iOS device. Source: config.js, line 60 × Search results Close "},"module-lib_error.html":{"id":"module-lib_error.html","title":"Module: lib/error","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/error Contains GlaceJS errors. Source: error.js, line 2 Classes ConfigError GlaceError StepError × Search results Close "},"module-lib_error-ConfigError.html":{"id":"module-lib_error-ConfigError.html","title":"Class: ConfigError","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: ConfigError lib/error~ ConfigError new ConfigError(message) Error which is thrown when configuration is wrong. Parameters: Name Type Description message string Error message. Source: error.js, line 26 × Search results Close "},"module-lib_error-GlaceError.html":{"id":"module-lib_error-GlaceError.html","title":"Class: GlaceError","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: GlaceError lib/error~ GlaceError new GlaceError(message) Error which is thrown in GlaceJS, if no more specific error is defined. Parameters: Name Type Description message string Error message. Source: error.js, line 16 × Search results Close "},"module-lib_error-StepError.html":{"id":"module-lib_error-StepError.html","title":"Class: StepError","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: StepError lib/error~ StepError new StepError(message) Error which is thrown when step execution is wrong. Parameters: Name Type Description message string Error message. Source: error.js, line 36 × Search results Close "},"module-lib_fixtures.html":{"id":"module-lib_fixtures.html","title":"Module: lib/fixtures","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/fixtures GlaceJS fixtures. Source: fixtures.js, line 2 × Search results Close "},"module-lib_globals.html":{"id":"module-lib_globals.html","title":"Module: lib/globals","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/globals Contains global framework functions and helpers. Source: globals.js, line 2 Members &lt;inner&gt; sessNum :Number Executed sessions counter. Type: Number Source: globals.js, line 100 Methods &lt;async, inner&gt; _killProcs(procName) Helper to kill processes by name. Parameters: Name Type Description procName string Process name or chunk of name. Source: globals.js, line 478 &lt;abstract, inner&gt; baseTest(name [, opts] [, fixtures], func) Basis for any test case. If test with the same was registered already, this test will be omitted with corresponding error in log. If retries amount is specified and this test was failed, the test will be added to queue in separated session with title containing Retry and its number. Parameters: Name Type Argument Description name string Name of test case. opts object &lt;optional&gt; Options. Properties Name Type Argument Default Description video boolean &lt;optional&gt; false Flag to involve video fixture. skip boolean &lt;optional&gt; false Flag to skip test. retry number &lt;optional&gt; 0 Number of retries on failure. May be managed in config. fixtures Array.&lt;function()&gt; &lt;optional&gt; Involved fixtures list. func function Test function. Source: globals.js, line 220 &lt;inner&gt; setLog() Helper to set actual log file. Source: globals.js, line 26 × Search results Close "},"module-lib_hacking.html":{"id":"module-lib_hacking.html","title":"Module: lib/hacking","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/hacking Contains hacks for test run. Source: hacking.js, line 2 Members &lt;inner&gt; _mochaRunner :Runner Mocha runner. Type: Runner Source: hacking.js, line 46 Methods &lt;static&gt; getRunner() Gets mocha runner. Source: hacking.js, line 58 &lt;static&gt; suppressMochaUncaught() Patches original Mocha.Runner.prototype.uncaught in order to skip exceptions from proxy server res.send(). Source: hacking.js, line 19 × Search results Close "},"module-lib_help.html":{"id":"module-lib_help.html","title":"Module: lib/help","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/help Help description. Source: help.js, line 2 × Search results Close "},"module-lib_image.html":{"id":"module-lib_image.html","title":"Module: lib/image","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/image Contains classes and functions to process images. Source: image.js, line 2 Classes Image × Search results Close "},"module-lib_image-Image.html":{"id":"module-lib_image-Image.html","title":"Class: Image","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: Image lib/image~ Image new Image(srcPath [, srcOpts]) Creates new instance of Image. Parameters: Name Type Argument Description srcPath string path to processed image srcOpts object &lt;optional&gt; image options Properties Name Type Argument Description scaleX number &lt;optional&gt; image current scale value on X axis scaleY number &lt;optional&gt; image current scale value on Y axis Source: image.js, line 22 Methods &lt;protected&gt; _cropPixels(pixels) Crops pixels, removes empty rows and columns. Parameters: Name Type Description pixels Array.&lt;Array.&lt;object&gt;&gt; pixels matrix Source: image.js, line 394 Returns: cropped pixels matrix Type Array.&lt;Array.&lt;object&gt;&gt; &lt;protected&gt; _cropTop(pixels) Crops top part of pixels matrix. Parameters: Name Type Description pixels Array.&lt;Array.&lt;object&gt;&gt; pixels matrix Source: image.js, line 415 Returns: cropped pixels matrix Type Array.&lt;Array.&lt;object&gt;&gt; &lt;protected&gt; _getDiffValue(srcPixels, dstPixels, offsetX, offsetY) Calculates difference between source pixels and destination pixels. Parameters: Name Type Description srcPixels Array.&lt;Array.&lt;object&gt;&gt; source pixels matrix dstPixels Array.&lt;Array.&lt;object&gt;&gt; destination pixels matrix offsetX number source left border offset offsetY number source top border offset Source: image.js, line 306 Returns: difference value Type number &lt;protected&gt; _getPixels(img) Retrieves pixels from image data. Parameters: Name Type Description img object image data Source: image.js, line 365 Returns: pixels matrix Type Array.&lt;Array.&lt;object&gt;&gt; &lt;protected&gt; _includes(src, dst) Defines whether one image data includes another. Parameters: Name Type Description src object source image data dst object destination image data, which is potentially included Source: image.js, line 247 Returns: result Type object &lt;protected&gt; _isPixelTolerant(srcPixel, dstPixel) Defines whether source pixel is tolerant to destination pixel. Parameters: Name Type Description srcPixel object source pixel dstPixel object destination pixel Source: image.js, line 347 Returns: true if pixels are tolerant, false otherwise Type boolean &lt;protected&gt; _isPixelUsed(pixel) Defines whether pixel should be used for difference calculation or no, according its alpha value. Parameters: Name Type Description pixel object pixel Source: image.js, line 335 Returns: true if should be, false otherwise Type boolean &lt;protected&gt; _loadImg(imgPath, imgOpts) Loads image. Parameters: Name Type Description imgPath string path loaded image imgOpts object image options Source: image.js, line 205 Returns: image data Type Promise.&lt;object&gt; &lt;protected&gt; _saveMatchImage(left, top, width, height) Saves matched part of image. Parameters: Name Type Description left number offset from left image border top number offset from top image border width number width of matched part height number height of matched part Source: image.js, line 233 Returns: Type Promise _transpose(pixels) Transposes pixels matrix. Parameters: Name Type Description pixels Array.&lt;Array.&lt;object&gt;&gt; pixels matrix Source: image.js, line 447 Returns: transposed pixels matrix Type Array.&lt;Array.&lt;object&gt;&gt; includes(dstPath [, dstOpts]) Defines if processed image includes specified image. Parameters: Name Type Argument Description dstPath string path to potentially included image dstOpts object &lt;optional&gt; included image options Properties Name Type Argument Default Description tolerance number &lt;optional&gt; 0.05 comparison tolerance matchedPath string &lt;optional&gt; &lt;nullable&gt; null path to same captured place saveMatch boolean &lt;optional&gt; false flag to capture images intersection or no Source: image.js, line 157 Returns: result Type Promise.&lt;object&gt; &lt;async&gt; isBlack() Defines whether processed image is black. Source: image.js, line 96 Returns: true if image is black, false otherwise. Type Promise.&lt;boolean&gt; &lt;async&gt; isMonochrome() Defines whether processed image is monochrome. Source: image.js, line 66 Returns: true if image is monochrome, false otherwise. Type Promise.&lt;boolean&gt; &lt;async&gt; isTransparent() Defines whether processed image is transparent. Source: image.js, line 42 Returns: true if image is transparent, false otherwise. Type Promise.&lt;boolean&gt; &lt;async&gt; isWhite() Defines whether processed image is white. Source: image.js, line 124 Returns: true if image is white, false otherwise. Type Promise.&lt;boolean&gt; × Search results Close "},"module-lib_index.html":{"id":"module-lib_index.html","title":"Module: lib/index","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/index GlaceJS main module. Properties: Name Type Description config object Config module. error object Error module. Page object Page module. reporter object Reporter module. run object run module. Steps object Steps module. Source: index.js, line 2 Members &lt;inner&gt; config :GlaceConfig Type: GlaceConfig Source: index.js, line 21 &lt;inner&gt; Page :Page Type: Page Source: index.js, line 36 &lt;inner&gt; reporter :GlaceReporter Type: GlaceReporter Source: index.js, line 45 &lt;inner&gt; run :run Type: run Source: index.js, line 54 &lt;inner&gt; Steps :Steps Type: Steps Source: index.js, line 63 × Search results Close "},"module-lib_matcher.html":{"id":"module-lib_matcher.html","title":"Module: lib/matcher","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/matcher Matchers. Source: matcher.js, line 2 × Search results Close "},"module-lib_page_element.html":{"id":"module-lib_page_element.html","title":"Module: lib/page/element","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/page/element Defines classes responsible for interaction with DOM in browser context. Source: page/element.js, line 2 Classes Element × Search results Close "},"module-lib_page_element-Element.html":{"id":"module-lib_page_element-Element.html","title":"Class: Element","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: Element lib/page/element~ Element new Element(name, driver) Creates a new instance of Element. Element binds DOM control in browser context with virtual control in test. Parameters: Name Type Description name string control name driver object selenium driver instance Source: page/element.js, line 22 Methods click() Clicks control in browser. Source: page/element.js, line 110 Returns: result of selenium execution in browser context Type Promise getElement() Gets webdriver element. Source: page/element.js, line 37 Returns: Webdriver element. Type object getText() Gets text content of DOM element. Source: page/element.js, line 46 Returns: text value or null Type Promise.&lt;string&gt; isExist() Defines whether control is exist or no. Source: page/element.js, line 165 Returns: true if control is exist, false otherwise Type Promise.&lt;boolean&gt; isSelected() Defines whether control is selected or no. Source: page/element.js, line 150 Returns: true if control is selected, false otherwise Type Promise.&lt;boolean&gt; isVisible() Defines whether control is visible or no. Source: page/element.js, line 207 Returns: true if control is visible, false otherwise Type Promise.&lt;boolean&gt; location() Gets DOM control location with attributes: x, y, midX, midY, width, height Source: page/element.js, line 75 Returns: location of control Type Promise.&lt;object&gt; pClick() Clicks element in browser via pointer events. Source: page/element.js, line 123 Returns: Type Promise scrollIntoView() Scrolls control into browser viewport. Source: page/element.js, line 97 Returns: result of javascript execution in browser context Type Promise.&lt;*&gt; setText(text) Sets text to DOM element. Parameters: Name Type Description text string Text value to assign. Source: page/element.js, line 65 Returns: Type Promise tap() Taps control in browser. Source: page/element.js, line 143 waitForExist( [timeout]) Waits for control is exist. Parameters: Name Type Argument Description timeout number &lt;optional&gt; timeout to wait, ms Source: page/element.js, line 177 Throws: If control isn't exist after timeout. Type TimeoutError Returns: result of selenium execution Type Promise.&lt;*&gt; waitForInvisible( [timeout]) Waits for control is invisible. Parameters: Name Type Argument Description timeout number &lt;optional&gt; timeout to wait, ms Source: page/element.js, line 238 Throws: If control is still visible after timeout. Type TimeoutError Returns: result of selenium execution Type Promise.&lt;*&gt; waitForNonExist( [timeout]) Waits for control isn't exist. Parameters: Name Type Argument Description timeout number &lt;optional&gt; timeout to wait, ms Source: page/element.js, line 193 Throws: If control is still exist after timeout. Type TimeoutError Returns: result of selenium execution Type Promise.&lt;*&gt; waitForVisible( [timeout]) Waits for control is visible. Parameters: Name Type Argument Description timeout number &lt;optional&gt; timeout to wait, ms Source: page/element.js, line 221 Throws: If control isn't visible after timeout. Type TimeoutError Returns: result of selenium execution Type Promise.&lt;*&gt; × Search results Close "},"module-lib_page_event.html":{"id":"module-lib_page_event.html","title":"Module: lib/page/event","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/page/event Browser events. Source: page/event.js, line 2 Classes PointerEvents × Search results Close "},"module-lib_page_event-PointerEvents.html":{"id":"module-lib_page_event-PointerEvents.html","title":"Class: PointerEvents","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: PointerEvents lib/page/event~ PointerEvents Contains browser pointer events. new PointerEvents() Creates a new pointer events instance. Source: page/event.js, line 15 Methods cancel(x, y) Cancel pointer on element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 118 Returns: Type Promise down(selector, x, y) Presses pointer down on element by selector. Parameters: Name Type Description selector string css selector x number x coordinate y number y coordinate Source: page/event.js, line 64 Returns: Type Promise enter(x, y) Enters pointer to element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 46 Returns: Type Promise leave(x, y) Leaves pointer from element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 154 Returns: Type Promise move(x, y) Moves pointer to element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 100 Returns: Type Promise out(x, y) Moves out pointer from element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 136 Returns: Type Promise over(x, y) Moves pointer over element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 28 Returns: Type Promise up(x, y) Unpresses pointer up on element by selector. Parameters: Name Type Description x number x coordinate y number y coordinate Source: page/event.js, line 82 Returns: Type Promise × Search results Close "},"module-lib_reporter_index.html":{"id":"module-lib_reporter_index.html","title":"Module: lib/reporter/index","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/reporter/index GlaceJS reporter package. Source: reporter/index.js, line 2 × Search results Close "},"module-lib_reporter_stdout.html":{"id":"module-lib_reporter_stdout.html","title":"Module: lib/reporter/stdout","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/reporter/stdout GlaceJS stdout reporter. Source: reporter/stdout.js, line 2 Methods done() Called on report finalizing. Source: reporter/stdout.js, line 187 end() Called before tests end. Source: reporter/stdout.js, line 87 fail(chunk) Called on chunk or hook failed. Parameters: Name Type Description chunk object MochaJS test. Source: reporter/stdout.js, line 161 pass(chunk) Called on chunk passed. Parameters: Name Type Description chunk object MochaJS test. Source: reporter/stdout.js, line 149 scope(scope) Called on scope start. Parameters: Name Type Description scope object MochaJS suite. Source: reporter/stdout.js, line 101 scopeEnd(scope) Called before scope end. Parameters: Name Type Description scope object MochaJS suite. Source: reporter/stdout.js, line 115 test(test) Called on test start. Parameters: Name Type Description test object MochaJS suite. Source: reporter/stdout.js, line 126 testEnd(test) Called on test end. Parameters: Name Type Description test object MochaJS suite. Source: reporter/stdout.js, line 138 × Search results Close "},"module-lib_reporter_testrail.html":{"id":"module-lib_reporter_testrail.html","title":"Module: lib/reporter/testrail","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/reporter/testrail TestRail reporter. Source: reporter/testrail.js, line 2 Methods done() Called on report finalizing. Source: reporter/testrail.js, line 137 end() Called before tests end. Source: reporter/testrail.js, line 77 start() Called on tests start. Source: reporter/testrail.js, line 36 testEnd(test) Called on test end. Parameters: Name Type Description test object MochaJS suite. Source: reporter/testrail.js, line 91 × Search results Close "},"module-lib_runner.html":{"id":"module-lib_runner.html","title":"Module: lib/runner","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/runner Makes tests root session. runner loads root conftest.js if it is located on one level with each of CONF.testDirs; if each of CONF.testDirs is file with tests, runner loads and executes it; if each of CONF.testDirs is folder runner loads files inside recursive if file name starts with test and ends with .js; inside each subfolder of each of CONF.testDirs runner loads conftest.js file if it is present; Source: runner.js, line 2 × Search results Close "},"module-lib_steps_image.html":{"id":"module-lib_steps_image.html","title":"Module: lib/steps/image","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/image Steps for screenshots and images. Source: steps/image.js, line 2 Mixins ImageSteps Methods &lt;async, protected&gt; _canvasScreenshot(imagePath [, opts]) Helper to make screenshot with html2canvas. Parameters: Name Type Argument Description imagePath string Path to screenshot which will be saved. opts object &lt;optional&gt; Helper options. Properties Name Type Argument Default Description cssSelector string &lt;optional&gt; &lt;nullable&gt; null CSS selector of DOM element which of screenshot should be made. timeout number &lt;optional&gt; 30000 Time to wait for screenshot is rendered, ms Source: steps/image.js, line 307 Throws: If screenshot will not be rendered during timeout. Type Error Returns: Type Promise.&lt;void&gt; &lt;async, protected&gt; _checkImagesEquivalence(actualImage, expectedImage [, opts]) Helper to check two images are equal or not equal. Parameters: Name Type Argument Description actualImage string Path to actual image. expectedImage string Path to expected image. opts object &lt;optional&gt; Helper options. Properties Name Type Argument Default Description diffDirPath string &lt;optional&gt; Path to diffs folder. threshold number &lt;optional&gt; 0.05 Threshold of divergence. shouldBe boolean &lt;optional&gt; true Flag to check whether image are equal or not equal. Source: steps/image.js, line 237 Throws: If actual image doesn't exist. Type AssertionError If expected image doesn't exist. Type AssertionError If result of images comparison don't pass requested parameters. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async, protected&gt; _cutElement(imagePath, elementName [, opts]) Helper to cut element from image. Parameters: Name Type Argument Description imagePath string Path to image which element will be cut from. elementName string Name of element which will be cut. opts object &lt;optional&gt; Helper options. Properties Name Type Argument Description name string &lt;optional&gt; Name of cut image with element. cutDirPath string &lt;optional&gt; Folder path to cut elements. Source: steps/image.js, line 385 Throws: If original image doesn't exist. Type AssertionError If DOM element is not registered in config. Type AssertionError If cut image is not saved. Type AssertionError Returns: Path to cut element image. Type Promise.&lt;string&gt; &lt;async, protected&gt; _seleniumScreenshot(imagePath) Helper to make screenshot with selenium. Parameters: Name Type Description imagePath string Path to screenshot which will be saved, Source: steps/image.js, line 288 Returns: Type Promise.&lt;void&gt; &lt;async&gt; checkImageInclusion(fullImage, includedImage [, opts]) Step to check one image includes or doesn't include another image. Parameters: Name Type Argument Description fullImage string Path to image which may include. includedImage string Path to image which may be included. opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description matchedDirPath object &lt;optional&gt; Folder path to save matched image. threshold number &lt;optional&gt; 0.05 Threshold of divergence. shouldBe boolean &lt;optional&gt; true Flag to check whether image are equal or not equal. Source: steps/image.js, line 144 Returns: Type Promise.&lt;void&gt; &lt;async&gt; checkImagesEquivalence(actualImage, expectedImage [, opts]) Step to check two image are equal or not equal Parameters: Name Type Argument Description actualImage string Path to actual image. expectedImage string Path to expected image. opts object &lt;optional&gt; Helper options. Properties Name Type Argument Default Description threshold number &lt;optional&gt; 0.05 Threshold of divergence. shouldBe boolean &lt;optional&gt; true Flag to check whether image are equal or not equal. elements Array.&lt;string&gt; &lt;optional&gt; [] List of elements on image which should be verified. Source: steps/image.js, line 115 Throws: If result of images comparison don't pass requested parameters. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; checkOrMakeScreenshot(imageName [, opts]) Step to check or make web screenshot in browser. Parameters: Name Type Argument Description imageName string Screenshot name. File extension .png will be added automatically. opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description imageDirPath string &lt;optional&gt; Screenshot folder path. expectedDirPath string &lt;optional&gt; Expected screenshot path. bySelenium boolean &lt;optional&gt; true Flag to use selenium to make screenshot. Other library html2canvas will be used. preHook function &lt;optional&gt; &lt;nullable&gt; null Function which will be called in Steps context in the beginning of step. postHook function &lt;optional&gt; &lt;nullable&gt; null Function which will be called in Steps context at the end of step. elements Array.&lt;string&gt; &lt;optional&gt; [] List of elements on image which should be verified. check boolean &lt;optional&gt; true Flag to check screenshot is saved or no. Source: steps/image.js, line 197 Throws: If screenshot isn't saved. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; makeScreenshot( [opts]) Step to make web screenshot in browser. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description imageName string &lt;optional&gt; Screenshot name. File extension .png will be added automatically. Default value is dynamically generated on each call with algorithm uuid. imageDirPath string &lt;optional&gt; Screenshot folder path. bySelenium boolean &lt;optional&gt; true Flag to use selenium to make screenshot. Other library html2canvas will be used. cssSelector string &lt;optional&gt; &lt;nullable&gt; null CSS selector of DOM element which of screenshot should be made. preHook function &lt;optional&gt; &lt;nullable&gt; null Function which will be called in Steps context in the beginning of step. postHook function &lt;optional&gt; &lt;nullable&gt; null Function which will be called in Steps context at the end of step. element string &lt;optional&gt; &lt;nullable&gt; null Web element name which should be screenshotted. check boolean &lt;optional&gt; true Flag to check screenshot is saved or no. Source: steps/image.js, line 52 Throws: If screenshot isn't saved. Type AssertionError Returns: Path to saved screenshot. Type Promise.&lt;string&gt; &lt;inner&gt; getScreensDir() Helper to get screenshots folder. Source: steps/image.js, line 452 × Search results Close "},"module-lib_steps_image-ImageSteps.html":{"id":"module-lib_steps_image-ImageSteps.html","title":"Mixin: ImageSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: ImageSteps lib/steps/image~ ImageSteps Steps to manage web screenshots and images. Source: steps/image.js, line 20 × Search results Close "},"module-lib_steps_page.html":{"id":"module-lib_steps_page.html","title":"Module: lib/steps/page","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/page Steps for page. Source: steps/page.js, line 2 Mixins PageSteps Methods &lt;protected, static&gt; _pages() Helper to initialize pages storage. Source: steps/page.js, line 95 &lt;async&gt; getCurrentPage() Step to get current page. Source: steps/page.js, line 76 Throws: If no one of registered pages corresponds to current browser URL. Type StepError Returns: Page which corresponds to current browser URL. Type Promise.&lt;Page&gt; &lt;async&gt; openPage(pageName) Step to open page. Parameters: Name Type Description pageName string Name of page to open. Source: steps/page.js, line 61 registerPages(pages) Helper to register pages. Parameters: Name Type Argument Description pages Page &lt;repeatable&gt; Sequence of pages. Source: steps/page.js, line 26 removePages(pageNames) Helper to remove pages. Parameters: Name Type Argument Description pageNames string &lt;repeatable&gt; Sequence of page names. Source: steps/page.js, line 43 × Search results Close "},"module-lib_steps_page-PageSteps.html":{"id":"module-lib_steps_page-PageSteps.html","title":"Mixin: PageSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: PageSteps lib/steps/page~ PageSteps Steps to manage page. Source: steps/page.js, line 13 × Search results Close "},"module-lib_steps_timer.html":{"id":"module-lib_steps_timer.html","title":"Module: lib/steps/timer","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/timer Time steps. Source: steps/timer.js, line 2 Mixins TimerSteps Methods checkTimer(condition) Step to check timer. Parameters: Name Type Description condition string | object chaijs condition. Source: steps/timer.js, line 40 Throws: If timer verification is failed. Type AssertionError startTimer() Step to start timer. Source: steps/timer.js, line 20 stopTimer() Step to stop timer. Source: steps/timer.js, line 29 × Search results Close "},"module-lib_steps_timer-TimerSteps.html":{"id":"module-lib_steps_timer-TimerSteps.html","title":"Mixin: TimerSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: TimerSteps lib/steps/timer~ TimerSteps Steps to measure time. Source: steps/timer.js, line 8 × Search results Close "},"module-lib_steps_video.html":{"id":"module-lib_steps_video.html","title":"Module: lib/steps/video","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/video Steps for video recording. Source: steps/video.js, line 2 Mixins VideoSteps Methods getVideo( [opts]) Step to get path to recorded video. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check that video is recorded and path exists. Source: steps/video.js, line 144 Returns: Path to recorded video. Type string removeVideo( [opts]) Step to remove recorded video. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check step result. Source: steps/video.js, line 171 Throws: If video file wasn't removed. Type AssertionError &lt;async&gt; startVideo( [opts]) Step to start video recording. Step recall will be skipped if video recording wasn't stopped before. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description name string &lt;optional&gt; File name. Extension .avi will be added automatically. Default name will be generated with uuid algorithm. path string &lt;optional&gt; Folder to save video. check boolean &lt;optional&gt; true Flag to check that video recording was launched. Source: steps/video.js, line 40 Throws: If video recording wasn't launched. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; stopVideo( [opts]) Step to stop video recording. Step call will be skipped if video recording wasn't launched before. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check that video recording was stopped. Source: steps/video.js, line 111 Throws: If video recording wasn't stopped. Type AssertionError Returns: Path to recorded video. Type Promise.&lt;string&gt; × Search results Close "},"module-lib_steps_video-VideoSteps.html":{"id":"module-lib_steps_video-VideoSteps.html","title":"Mixin: VideoSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: VideoSteps lib/steps/video~ VideoSteps Steps to manage video recording. Source: steps/video.js, line 17 × Search results Close "},"module-lib_steps_web.html":{"id":"module-lib_steps_web.html","title":"Module: lib/steps/web","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/web Steps for web applications. Source: steps/web.js, line 2 Mixins WebSteps Methods &lt;async&gt; closeBrowser( [opts]) Step to close browser. Step will be skipped if browser wasn't launched before. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check that browser was closed. Source: steps/web.js, line 162 Throws: If browser wasn't closed. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; installSeleniumDrivers() Step to install selenium drivers. Source: steps/web.js, line 26 Throws: If there was error during drivers installation. Type Error Returns: Type Promise.&lt;void&gt; &lt;async&gt; launchBrowser( [opts]) Step to launch browser. Step recall will be skipped if browser wasn't closed before. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check that browser was launched. Source: steps/web.js, line 113 Throws: If browser wasn't launched. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; openApp( [opts]) Step to open application URL in browser. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Source: steps/web.js, line 239 Throws: If application URL is not defined. Type AssertionError Returns: Type Promise.&lt;void&gt; &lt;async&gt; openUrl(pageUrl [, opts]) Step to open URL in browser. Parameters: Name Type Argument Description pageUrl string URL which should be opened in browser. opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description check boolean &lt;optional&gt; true Flag to check that URL is opened. timeout number &lt;optional&gt; Timeout to wait for URL will be opened in browser, ms. Default value is CONF.timeouts.pageLoad. Source: steps/web.js, line 209 Throws: If URL wasn't opened after timeout. Type Error Returns: Type Promise.&lt;void&gt; &lt;async&gt; restartBrowser( [opts]) Step to restart browser. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Source: steps/web.js, line 191 Returns: Type Promise.&lt;void&gt; &lt;async&gt; startSeleniumServer() Step to start selenium server. Step recall will be skipped if selenium server wasn't stopped before. Source: steps/web.js, line 50 Throws: If there was error on selenium start. Type Error Returns: Type Promise.&lt;void&gt; &lt;async&gt; stopSeleniumServer() Step to stop selenium server. Step call will be skipped if selenium server wasn't started before. Source: steps/web.js, line 79 Throws: If there was error on selenium stop. Type Error Returns: Type Promise.&lt;void&gt; × Search results Close "},"module-lib_steps_web-WebSteps.html":{"id":"module-lib_steps_web-WebSteps.html","title":"Mixin: WebSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: WebSteps lib/steps/web~ WebSteps Steps to manage web application. Source: steps/web.js, line 11 × Search results Close "},"module-lib_steps_xvfb.html":{"id":"module-lib_steps_xvfb.html","title":"Module: lib/steps/xvfb","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/steps/xvfb Steps for virtual display. Source: steps/xvfb.js, line 2 Mixins XvfbSteps Methods &lt;async&gt; startXvfb( [opts]) Step to start virtual display. Step recall will be skipped if virtual display wasn't stopped before. Parameters: Name Type Argument Description opts object &lt;optional&gt; Step options. Properties Name Type Argument Default Description width number &lt;optional&gt; Virtual display width. By default corresponds to active display. height number &lt;optional&gt; Virtual display height. By default corresponds to active display. depth number &lt;optional&gt; 24 Virtual display color depth. timeout number &lt;optional&gt; 1000 Time to wait for virtual display will be started, ms. Source: steps/xvfb.js, line 36 Returns: Type Promise.&lt;void&gt; stopXvfb() Step to stop virtual display. Step call will be skipped if virtual display wasn't started before. Source: steps/xvfb.js, line 66 × Search results Close "},"module-lib_steps_xvfb-XvfbSteps.html":{"id":"module-lib_steps_xvfb-XvfbSteps.html","title":"Mixin: XvfbSteps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Mixin: XvfbSteps lib/steps/xvfb~ XvfbSteps Steps to manage virtual display. Source: steps/xvfb.js, line 13 × Search results Close "},"module-lib_testing.html":{"id":"module-lib_testing.html","title":"Module: lib/testing","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/testing Contains classes and functions to save executed tests data. Source: testing.js, line 2 Classes TestCase × Search results Close "},"module-lib_testing-TestCase.html":{"id":"module-lib_testing-TestCase.html","title":"Class: TestCase","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: TestCase lib/testing~ TestCase new TestCase(name) Test case data structure. Contains full information and history about test case. Parameters: Name Type Description name string Test case name. Source: testing.js, line 17 Methods addError(err) Adds error to test case. Parameters: Name Type Description err Error Error. Source: testing.js, line 50 addFailedParams(params) Adds failed params if they don't exist. Parameters: Name Type Description params object Params which test was failed with. Source: testing.js, line 38 addScreenshot(imagePath) Adds screenshot. Parameters: Name Type Description imagePath string Path to saved screenshot. Source: testing.js, line 59 reset() Resets test case info. Source: testing.js, line 26 × Search results Close "},"module-lib_video.html":{"id":"module-lib_video.html","title":"Module: lib/video","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Module: lib/video Classes and functions for video recording. Source: video.js, line 2 Classes VideoRecorder × Search results Close "},"module-lib_video-VideoRecorder.html":{"id":"module-lib_video-VideoRecorder.html","title":"Class: VideoRecorder","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: VideoRecorder lib/video~ VideoRecorder contains methods to record video for tests new VideoRecorder() Creates a new instance of VideoRecorder. Properties: Name Type Argument Default Description isRunning boolean false flag is video recorder running or no filePath string &lt;nullable&gt; null path video file Source: video.js, line 24 Methods configure( [opts]) Configures video recorder. Parameters: Name Type Argument Description opts object &lt;optional&gt; recorder configuration Properties Name Type Argument Default Description fps number &lt;optional&gt; 30 video framerate width number &lt;optional&gt; 1024 video width height number &lt;optional&gt; 768 video height x number &lt;optional&gt; 0 X-offset on display y number &lt;optional&gt; 0 Y-offset on display Source: video.js, line 42 start() Starts video recorder. Source: video.js, line 97 Throws: if video recorder is started already Type Error if video recorder isn't configured yet Type Error stop() Stops video recorder. Source: video.js, line 112 Throws: if video recorder isn't started yet Type Error × Search results Close "},"Page.html":{"id":"Page.html","title":"Class: Page","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: Page Page new Page(name, pageUrl, elements) Page of browser. Parameters: Name Type Description name string Name of page. pageUrl string URL of page. elements object Element names and selectors dictionary. Source: page/index.js, line 2 Methods addElements(elements) Adds elements to page. Parameters: Name Type Description elements object Element names and selectors dictionary. Source: page/index.js, line 53 getDriver() Gets webdriver. Source: page/index.js, line 41 Throws: If webdriver isn't set yet. Type AssertionError Returns: Webdriver instance. Type object removeElements(elementNames) Removes elements from page. Parameters: Name Type Argument Description elementNames string &lt;repeatable&gt; Sequence of element names. Source: page/index.js, line 71 setDriver(webdriver) Sets webdriver for page. Parameters: Name Type Description webdriver object Webdriver instance. Source: page/index.js, line 31 × Search results Close "},"Steps.html":{"id":"Steps.html","title":"Class: Steps","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Class: Steps Steps new Steps() Steps collection which will be executed in test cases. Mixes In: ImageSteps PageSteps ProxySteps TimerSteps VideoSteps WebSteps XvfbSteps Source: steps/index.js, line 2 Methods &lt;static&gt; register() Registers sequence of objects containing steps. Source: steps/index.js, line 60 &lt;async&gt; pause(timeout, message) Step to make pause in another step or test case. Good style to rid of its direct usage in test case, only inside other step. Parameters: Name Type Description timeout number Pause time, sec. message string Pause reason. Source: steps/index.js, line 49 Returns: Type Promise.&lt;void&gt; setWebdriver(webdriver) Sets webdriver. It's used for web ui test cases. Parameters: Name Type Description webdriver object Instance of webdriver. Source: steps/index.js, line 36 × Search results Close "},"tutorial-conftest.html":{"id":"tutorial-conftest.html","title":"Tutorial: How to use conftest.js","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest How to use conftest.js File conftest.js is used to make some configuration before tests loading. It may be located with tests file or inside each folder containing tests files. In order to make some functions available inside a test, you may use global namespace: // conftest.js global.someFunc = () =&gt; console.log(&quot;hello world&quot;);test(&quot;My test&quot;, () =&gt; { chunk(() =&gt; someFunc()); }); × Search results Close "},"tutorial-console-args.html":{"id":"tutorial-console-args.html","title":"Tutorial: Command line arguments","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Command line arguments GlaceJS supports follow command line arguments: &lt;paths&gt; (optional) - Sequence of file or folder paths, where tests are located. For example, glace myTests.js or glace path/to/tests-folder. In folder it loads files with tests recursively. If file with tests is not specified directly, it loads files with prefix test and extension .js only. If argument is not specified, it looks inside folder tests in current work directory. --web (optional) - Activates steps for web testing in browser via selenium. If option is specified, selenium server and browser will launched automatically on session begin and will be stopped at session end. --dont-install-drivers (optional) - Don't install selenium webdrivers on session start. --platform &lt;type&gt; (optional) - Platfrom type. Supported values are pc, android, ios. Default value is pc. For example, --platform android. --browser &lt;name&gt; (optional) - Browser name. Default value is specific for platform: chrome for pc, chrome for android, safari for ios. For example, --browser firefox. --selenium-addr &lt;address&gt; (optional) - Selenium or appium network address. For example, --selenium-addr 192.168.0.9:4004. If it is not specified, local selenium server with default options will be started. --device &lt;name&gt; (optional) - Mobile device name. For example, --device &quot;My iPhone&quot; or --device Our_Android. Look for actual value for mobile device in its settings. --os-version &lt;version&gt; (optional) - Mobile OS version. For example, --os-version 9.0.3 or --os-version 5.0.5. --udid &lt;UDID&gt; (optional) - Mobile device UDID. --ios-engine &lt;engineName&gt; (optional) - iOS driver engine name. Default value is XCUITest. --retry &lt;times&gt; (optional) - Number of times to retry a failed test case. --stdout-log (optional) - Print log to console stdout. --allow-uncaught (optional) - Use mochajs processing of uncaught exceptions. × Search results Close "},"tutorial-middleware.html":{"id":"tutorial-middleware.html","title":"Tutorial: How to use own middleware","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest How to use own middleware First please see example how to develop and include own proxy middleware. By default GlaceJS supports 3 middlewares: to gather responses info to manage responses speed to cache and replay responses Your middleware may be registered just adding it to array (see example). Middleware will be used in all supported proxies and executed inside proxy context. If you want to prevent middleware calling after your middleware you should return true inside it. × Search results Close "},"tutorial-reporter.html":{"id":"tutorial-reporter.html","title":"Tutorial: How to use own reporter","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest How to use own reporter GlaceJS supports multiple reporters. And you may register your own reporter. Please see example in order to note full list of supported hooks in reporting. × Search results Close "},"tutorial-uncaught.html":{"id":"tutorial-uncaught.html","title":"Tutorial: Why GlaceJS suppresses uncaught exceptions","body":" GlaseJS Namespaces lib/config~GlaceConfig Modules lib/clilib/configlib/errorlib/fixtureslib/globalslib/hackinglib/helplib/imagelib/indexlib/matcherlib/page/elementlib/page/eventlib/reporter/indexlib/reporter/stdoutlib/reporter/testraillib/runnerlib/steps/imagelib/steps/pagelib/steps/timerlib/steps/videolib/steps/weblib/steps/xvfblib/testinglib/video Classes GlaceReporterlib/error~ConfigErrorlib/error~GlaceErrorlib/error~StepErrorlib/image~Imagelib/page/element~Elementlib/page/event~PointerEventslib/testing~TestCaselib/video~VideoRecorderPageSteps Mixins lib/steps/image~ImageStepslib/steps/page~PageStepslib/steps/timer~TimerStepslib/steps/video~VideoStepslib/steps/web~WebStepslib/steps/xvfb~XvfbSteps Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Global afterChunkafterSessionbeforeChunkbeforeSessionchunkCONFexpectfixBrowserfixGlobalProxyfixHttpProxyfixSeleniumfixVideofixWebdriverfixXvfbforEachLanguagereportersrunscopesessionSStest Why GlaceJS suppresses uncaught exceptions Uncaught exceptions is really dangerous thing, that may break your mochajs tests queue. Let's consider code example with async calls and uncaught exceptions. /* sample.js */ var sleep = timeout =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { console.log(`I was sleeping ${timeout} ms`); resolve(); }, timeout); }); }; var error = timeout =&gt; { setTimeout(() =&gt; { throw new Error(&quot;BOOM!!!&quot;); }, timeout); }; describe(&quot;scope&quot;, () =&gt; { it (&quot;test #1&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #2&quot;, async () =&gt; await sleep(1000)); it (&quot;test #3&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #4&quot;, async () =&gt; await sleep(1000)); it (&quot;test #5&quot;, async () =&gt; await sleep(1000)); it (&quot;test #6&quot;, async () =&gt; await sleep(1000)); });Execute it and get something really strange in report: $ mocha sample.js scope 1) test #1 # in console it colored as red (failed) I was sleeping 1000 ms √ test #1 (1012ms) 2) test #3 # in console it colored as red (failed) I was sleeping 1000 ms I was sleeping 1000 ms √ test #4 √ test #4 I was sleeping 1000 ms I was sleeping 1000 ms I was sleeping 1000 ms √ test #6 (1002ms) √ test #6 (1002ms) √ test #6 (1003ms) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15 Pay attention, that test #1 is mentioned twice: as passed and as failed! test #2 &amp; test #5 are absent in report! You may see concurrent printing of messages I was sleeping 1000 ms, 1 time, 2 times, 3 times. Let's see why it happens. The problem, that by default mochajs processes uncaught exceptions: https://github.com/mochajs/mocha/blob/master/lib/runner.js#L698. And if such exception happens, mochajs fails currently executed test. And it doesn't matter whether such exception happens in current test or was born many tests ago (due to unstopped timer, for example). This processing is implemented via listener, and in above example very interesting things happen: In test #1 on one hand uncaught exception happens after 1 second and its processing starts. On the other hand, test #1 waits for sleep finishing 1 second and then mochajs marks it as passed. Due to async of JavaScript, there are two concurrently test #1 processors, that leads to test #1 reporting twice. More over, since there are two places, which emit events to start new test execution. And factically, there are two tests queues. In test #3 previous situation repeats. And there are 3 concurrently executed tests queues! The evidence is a number of printed messages I was sleeping 1000 ms. How to fix Simple and working variant is to suppress uncaught exception. var Mocha = require(&quot;mocha&quot;); Mocha.Runner.prototype.uncaught = function (err) { logger.error(&quot;UNCAUGHT ERROR&quot;, err); };It's better to get one failed test and in test finalizers to close all descriptors, to stop proxies, to kill processes and so on, than to get fully failed tests queue in nightly build. That's why mechanism to suppress uncaught exceptions is enabled by default in GlaceJS. But it may be disabled with option --allow-uncaught. × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
