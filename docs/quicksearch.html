<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"cli.js.html":{"id":"cli.js.html","title":"Source: cli.js","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Source: cli.js &quot;use strict&quot;; /** * Contains functions to execute tests via command line interface. * * @module */ require(&quot;glace-core&quot;).config; // configuration is before all! require(&quot;glace-core&quot;).help(); const run = require(&quot;./run&quot;); /** * Runs `GlaceJS` in CLI. * * @function */ module.exports.run = () =&gt; run(process.exit); × Search results Close "},"globals.js.html":{"id":"globals.js.html","title":"Source: globals.js","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Source: globals.js &quot;use strict&quot;; /** * Contains global framework functions and helpers. * * @module */ const glaceSession = session; global.session = (name, fixtures, func) =&gt; { if (name instanceof Function) { func = name; name = null; fixtures = []; }; if (fixtures instanceof Function) { func = fixtures; fixtures = []; }; fixtures = fixtures || []; if (CONF.web.use &amp;&amp; !CONF.cluster.slavesNum) fixtures.push(fxKillWebdriver); if (CONF.xvfb.use) fixtures.push(fxXvfb); if (CONF.proxy.global) fixtures.push(fxGlobalProxy); if (CONF.proxy.http) fixtures.push(fxHttpProxy); if (CONF.web.use &amp;&amp; !CONF.webdriver.host) fixtures.push(fxSelenium); if (CONF.web.use) fixtures.push(fxWebdriver); if (CONF.web.use) fixtures.push(fxBrowser); if (CONF.image.screenOnFail) fixtures.push(fxScreenOnFail); glaceSession(name, fixtures, func); }; × Search results Close "},"index.js.html":{"id":"index.js.html","title":"Source: index.js","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Source: index.js &quot;use strict&quot;; /** * `GlaceJS` main module. * * @module * * @prop {object} config - {@link module:config|Config} module. * @prop {object} error - {@link module:error|Error} module. * @prop {object} Page - {@link module:page/index|Page} module. * @prop {object} reporter - {@link module:reporter/index|Reporter} module. * @prop {object} run - {@link module:run|run} module. * @prop {object} Steps - {@link module:steps|Steps} module. */ let allure, config, error, help, plugins, Page, reporter, run, Steps; Object.defineProperties(exports, { allure: { get: function () { allure = allure || require(&quot;glace-core&quot;).allure; return allure; }, }, /** * @type {GlaceConfig} */ config: { get: function () { config = config || require(&quot;glace-core&quot;).config; return config; }, }, error: { get: function () { error = error || require(&quot;glace-core&quot;).error; return error; }, }, help: { get: function () { help = help || require(&quot;glace-core&quot;).help; return help; }, }, plugins: { get: function () { plugins = plugins || require(&quot;glace-core&quot;).plugins; return plugins; }, }, /** * @type {Page} */ Page: { get: function () { Page = Page || require(&quot;glace-web&quot;).Page; return Page; }, }, /** * @type {GlaceReporter} */ reporter: { get: function () { reporter = reporter || require(&quot;glace-core&quot;).reporter; return reporter; }, }, /** * @type {run} */ run: { get: function () { run = run || require(&quot;./run&quot;); return run; }, }, /** * @type {Steps} */ Steps: { get: function () { Steps = Steps || require(&quot;glace-core&quot;).Steps; return Steps; }, }, }); × Search results Close "},"run.js.html":{"id":"run.js.html","title":"Source: run.js","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Source: run.js &quot;use strict&quot;; /** * Runs tests. * * @module */ const path = require(&quot;path&quot;); const glace = require(&quot;glace-core&quot;); glace.config.session.preloads.push(path.resolve(__dirname, &quot;globals.js&quot;)); module.exports = glace.run; × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Modules × Search results Close "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Tutorials × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Glace (fr. glacé — ice, frozen) is a cold drink based on coffee with addition of ice cream. GlaceJS is a quick-start functional testing framework based on mocha and extensible with plugins. glace-js is aggregation project which includes glace-core and its plugins: glace-image glace-proxy glace-testgen glace-video glace-web glace-xvfb Binary software which may be used java for selenium server usage; chrome browser for web tests; imagemagick (unix only) for images comparison (on windows will be installed together with framework); avconv (linux only) for video capture. On windows ffmpeg is used which will be installed together with framework. On macOS isn't implemented still; compiler for native nodejs modules. On windows may be installed with npm i -g windows-build-tools; How to installUse npm: npm i glace-jsFor development: git clone https://github.com/glacejs/glace-js.git cd glace-js npm iHow to useglace [options] [sequence-of-test-files-or-folders]In order to see all CLI options use command (plugin commands will be shown too): glace -hCLI optionsArguments --config [path], -c - Path to JSON file with CLI arguments. Default is cwd/config.json (if it exists). Note! All options below may be set via .json file (see option --config above). Log --stdout-log - Print log messages to stdout. --log [path] - Path to log file. Default is cwd/glace.log. --log-level [level] - Log level. Default is debug. Core --user-config [path] - Path to JS file with configuration which will be merged with override default configuration. Default is cwd/config.js (if it exists). --session-name [name] - Tests run session name. Default value includes word session and datetime. --grep &lt;pattern&gt;, -g - Filter tests by name or name chunk (by mocha). --include &lt;sequence&gt; - Sequence of test name chunks separated by | in order to choose tests for run. --exclude &lt;sequence&gt; - Sequence of test name chunks separated by | in order to exclude tests from run. --precise - Precise tests inclusion or exclusion (not substring pattern). --report [path] - Path to reports folder. Default is cwd/report. --dont-clear-report - Don't clear previous report on tests run. --dont-check-names - Don't check test names uniqueness (usually useful in unit testing). --failed-tests-path [path] - Path to save failed tests in JSON format. Default is cwd/report/failed-tests.json. --root-conftest &lt;path&gt; - Path to root conftest.js which will be loaded before all. --languages &lt;sequence&gt; - List of tested languages separated with comma. --retry [times] - Number of times to retry failed test. Default is 0. --chunk-retry [times] - Number of times to retry failed chunk. Default is 0. --chunk-timeout [sec] - Time to execute chunk or hook, sec. Default is 180. --uncaught [type] - Strategy to process uncaught exceptions. Default value is log. Supported values are log, fail, mocha. See details in https://glacejs.github.io/glace-core. --kill-procs &lt;sequence&gt; - List of process names separated with comma, which will be killed before tests run. --debug-on-fail - Enter to interactive debug mode on step failure. Incompatible with --slaves option. --exit-on-fail - Finish test run on first failure. --errors-now - Print error message immediately when it happened. --interactive, -i - Launch interactive mode to execute steps manually in terminal. Incompatible with --slaves option. --slaves &lt;number|auto&gt; - Split tests by slaves and execute them in separated processes in parallel. If it is auto, slaves amount will be equal to process cores amount. Plugins --list-plugins - List installed plugins and exit. --plugins-dir [path] - Path to custom plugins folder. By default it searches plugins inside folder, where glace-core is installed. --disable-default-plugins - Disable default plugins. xUnit --xunit - Activate xUnit reporter. --xunit-path [path] - Path to xUnit report. Default is cwd/report/xunit.xml. --xunit-suite-name [name] - Tests suite name in xUnit report. By default it's the same as session name. Allure --allure - Activate Allure reporter. --allure-dir [path] - Path to allure reports folder. Default is cwd/report/allure. TestRail --testrail - Activate testrail reporter. --testrail-host &lt;host&gt; - TestRail host. --testrail-user &lt;user&gt; - TestRail username or email. --testrail-token &lt;token&gt; - TestRail token. --testrail-project-id &lt;id&gt; - TestRail project id. --testrail-suite-id &lt;id&gt; - TestRail suite id. --testrail-run-name &lt;name&gt; - TestRail run name. --testrail-run-desc &lt;description&gt; - TestRail run description. Tools --testrail-check - Check TestRail cases consistency with implemented tests. --list-steps [filter] - List available steps and exit. --list-tests [filter] - List collected tests and exit. --list-fixtures [filter] - List available fixtures and exit. Image --screenshot-on-fail - Capture screenshot on chunk fail. Proxy --http-proxy - Use http proxy. --http-proxy-port [number] - Port for http proxy. Default is random. Incompatible with --slaves option. --global-proxy - Use transparent global proxy. --global-proxy-port [number] - Port for transparent global proxy. Default is random. Incompatible with --slaves option. --cache - Enable middleware to cache proxy responses to disk. --existing-cache - Use existing cache if it exists. --cache-folder [folder] - Folder to put cached server responses. Default is cwd/report/.proxy-cache. --speed &lt;value&gt; - Proxy speed, kb/s. --install-certificate - Install global proxy certificate as trusted. Requires administrator permissions. --ssl-ca-dir [folder] - Folder to put generated self-signed SSL certificates. Default is cwd/report/.certificats. --reconnect [number] - Number of proxy reconnects on request error. Default is 2. Test-gen --gen-steps-filter &lt;chunk&gt; - Chunk of step name to filter tests. --gen-steps-uniq [number] - Number of steps in unique sequence to filter tests. Default is unlimited. --gen-steps-limit [number] - Maximum amount of steps per test. Default is unlimited. --gen-steps-usage &lt;number&gt; - Number of steps usage in test case. --gen-steps-files &lt;sequence&gt; - Space-separated sequence of paths to steps file (yaml or json format). As alternate to specify path to steps file in plugin mode. --gen-tests-limit [number] - Maximum amount of generated tests per iteration. Default is 1000000. --gen-tests-max &lt;number&gt; - Maximum amount of final tests. --gen-tests-files &lt;sequence&gt; - Space-separated sequence of paths to files with pregenerated tests (yaml or json format). --gen-tests-only - Flag to exclude other found tests and launch only generated tests in plugin mode. --gen-tests-shuffle - Shuffle tests during generating. Provides more steps sequence randomization, but tests will be different in generating runs. --gen-load-train &lt;path&gt; - Path to file with pretrained model, which will be loaded before generating. --gen-train-before &lt;path&gt; - Path to file with tests for training before generating. --gen-names-only - Flag to print only step names. Video --video - Capture video of executed tests. Video will be removed if test is passed. --video-save - Capture video of executed tests. Video will be saved even if test is passed. Selenium --web - Flag to launch tests in browser. --web-url &lt;URL&gt; - Web URL which will be used for web tests. --web-resolution &lt;widthxheight&gt; - Browser viewport size (pc platform only). --selenium-address &lt;host:port&gt; - Connect to launched selenium server with this address. --platform [type] - Specify platform type where tests will be executed. Default is pc. Supported values are pc, android, ios. --browser &lt;name&gt; - Name of browser where web tests will be executed. Default value is platform specific. Appium --device &lt;name&gt; - Mobile device name. --os-version &lt;value&gt; - Mobile operating system version. --ios-engine &lt;name&gt; - iOS automation engine name. --udid &lt;value&gt; - Mobile device UDID. Chrome --chrome-incognito - Launch chrome in incognito mode. --chrome-headless - Launch chrome in headless mode. --chrome-options - Provide space-separated chrome options with key=value style. Virtual display --xvfb [&lt;width&gt;x&lt;height&gt;] - Use xvfb for headless testing. Common --version - Show version number. -h, --help - Show help. ExamplesSee glace-core e2e tests in order to explore basic examples. See glace-js e2e tests in order to explore plugin examples. × Search results Close "},"module-cli.html":{"id":"module-cli.html","title":"Module: cli","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Module: cli Contains functions to execute tests via command line interface. Source: cli.js, line 3 Methods &lt;static&gt; run() Runs GlaceJS in CLI. Source: cli.js, line 18 × Search results Close "},"module-globals.html":{"id":"module-globals.html","title":"Module: globals","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Module: globals Contains global framework functions and helpers. Source: globals.js, line 3 × Search results Close "},"module-index.html":{"id":"module-index.html","title":"Module: index","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Module: index GlaceJS main module. Properties: Name Type Description config object Config module. error object Error module. Page object Page module. reporter object Reporter module. run object run module. Steps object Steps module. Source: index.js, line 3 Members &lt;inner&gt; config :GlaceConfig Type: GlaceConfig Source: index.js, line 28 &lt;inner&gt; Page :Page Type: Page Source: index.js, line 55 &lt;inner&gt; reporter :GlaceReporter Type: GlaceReporter Source: index.js, line 64 &lt;inner&gt; run :run Type: run Source: index.js, line 73 &lt;inner&gt; Steps :Steps Type: Steps Source: index.js, line 82 × Search results Close "},"module-run.html":{"id":"module-run.html","title":"Module: run","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Module: run Runs tests. Source: run.js, line 3 × Search results Close "},"tutorial-conftest.html":{"id":"tutorial-conftest.html","title":"Tutorial: How to use conftest.js","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions How to use conftest.js File conftest.js is used to make some configuration before tests loading. It may be located with tests file or inside each folder containing tests files. In order to make some functions available inside a test, you may use global namespace: // conftest.js global.someFunc = () =&gt; console.log(&quot;hello world&quot;);test(&quot;My test&quot;, () =&gt; { chunk(() =&gt; someFunc()); }); × Search results Close "},"tutorial-console-args.html":{"id":"tutorial-console-args.html","title":"Tutorial: Command line arguments","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Command line arguments GlaceJS supports follow command line arguments: &lt;paths&gt; (optional) - Sequence of file or folder paths, where tests are located. For example, glace myTests.js or glace path/to/tests-folder. In folder it loads files with tests recursively. If file with tests is not specified directly, it loads files with prefix test and extension .js only. If argument is not specified, it looks inside folder tests in current work directory. --web (optional) - Activates steps for web testing in browser via selenium. If option is specified, selenium server and browser will launched automatically on session begin and will be stopped at session end. --dont-install-drivers (optional) - Don't install selenium webdrivers on session start. --platform &lt;type&gt; (optional) - Platfrom type. Supported values are pc, android, ios. Default value is pc. For example, --platform android. --browser &lt;name&gt; (optional) - Browser name. Default value is specific for platform: chrome for pc, chrome for android, safari for ios. For example, --browser firefox. --selenium-addr &lt;address&gt; (optional) - Selenium or appium network address. For example, --selenium-addr 192.168.0.9:4004. If it is not specified, local selenium server with default options will be started. --device &lt;name&gt; (optional) - Mobile device name. For example, --device &quot;My iPhone&quot; or --device Our_Android. Look for actual value for mobile device in its settings. --os-version &lt;version&gt; (optional) - Mobile OS version. For example, --os-version 9.0.3 or --os-version 5.0.5. --udid &lt;UDID&gt; (optional) - Mobile device UDID. --ios-engine &lt;engineName&gt; (optional) - iOS driver engine name. Default value is XCUITest. --retry &lt;times&gt; (optional) - Number of times to retry a failed test case. --stdout-log (optional) - Print log to console stdout. --allow-uncaught (optional) - Use mochajs processing of uncaught exceptions. × Search results Close "},"tutorial-middleware.html":{"id":"tutorial-middleware.html","title":"Tutorial: How to use own middleware","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions How to use own middleware First please see example how to develop and include own proxy middleware. By default GlaceJS supports 3 middlewares: to gather responses info to manage responses speed to cache and replay responses Your middleware may be registered just adding it to array (see example). Middleware will be used in all supported proxies and executed inside proxy context. If you want to prevent middleware calling after your middleware you should return true inside it. × Search results Close "},"tutorial-reporter.html":{"id":"tutorial-reporter.html","title":"Tutorial: How to use own reporter","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions How to use own reporter GlaceJS supports multiple reporters. And you may register your own reporter. Please see example in order to note full list of supported hooks in reporting. × Search results Close "},"tutorial-uncaught.html":{"id":"tutorial-uncaught.html","title":"Tutorial: Why GlaceJS suppresses uncaught exceptions","body":" GlaceJS Modules cliglobalsindexrun Tutorials How to use conftest.jsCommand line argumentsHow to use own middlewareHow to use own reporterWhy GlaceJS suppresses uncaught exceptions Why GlaceJS suppresses uncaught exceptions Uncaught exceptions is really dangerous thing, that may break your mochajs tests queue. Let's consider code example with async calls and uncaught exceptions. /* sample.js */ var sleep = timeout =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { console.log(`I was sleeping ${timeout} ms`); resolve(); }, timeout); }); }; var error = timeout =&gt; { setTimeout(() =&gt; { throw new Error(&quot;BOOM!!!&quot;); }, timeout); }; describe(&quot;scope&quot;, () =&gt; { it (&quot;test #1&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #2&quot;, async () =&gt; await sleep(1000)); it (&quot;test #3&quot;, async () =&gt; { error(1000); await sleep(1000); }); it (&quot;test #4&quot;, async () =&gt; await sleep(1000)); it (&quot;test #5&quot;, async () =&gt; await sleep(1000)); it (&quot;test #6&quot;, async () =&gt; await sleep(1000)); });Execute it and get something really strange in report: $ mocha sample.js scope 1) test #1 # in console it colored as red (failed) I was sleeping 1000 ms √ test #1 (1012ms) 2) test #3 # in console it colored as red (failed) I was sleeping 1000 ms I was sleeping 1000 ms √ test #4 √ test #4 I was sleeping 1000 ms I was sleeping 1000 ms I was sleeping 1000 ms √ test #6 (1002ms) √ test #6 (1002ms) √ test #6 (1003ms) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 6 passing (3s) 2 failing 1) scope test #1: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15) 2) scope test #3: Uncaught Error: BOOM!!! at Timeout.setTimeout [as _onTimeout] (proba.js:12:15 Pay attention, that test #1 is mentioned twice: as passed and as failed! test #2 &amp; test #5 are absent in report! You may see concurrent printing of messages I was sleeping 1000 ms, 1 time, 2 times, 3 times. Let's see why it happens. The problem, that by default mochajs processes uncaught exceptions: https://github.com/mochajs/mocha/blob/master/lib/runner.js#L698. And if such exception happens, mochajs fails currently executed test. And it doesn't matter whether such exception happens in current test or was born many tests ago (due to unstopped timer, for example). This processing is implemented via listener, and in above example very interesting things happen: In test #1 on one hand uncaught exception happens after 1 second and its processing starts. On the other hand, test #1 waits for sleep finishing 1 second and then mochajs marks it as passed. Due to async of JavaScript, there are two concurrently test #1 processors, that leads to test #1 reporting twice. More over, since there are two places, which emit events to start new test execution. And factically, there are two tests queues. In test #3 previous situation repeats. And there are 3 concurrently executed tests queues! The evidence is a number of printed messages I was sleeping 1000 ms. How to fix Simple and working variant is to suppress uncaught exception. var Mocha = require(&quot;mocha&quot;); Mocha.Runner.prototype.uncaught = function (err) { logger.error(&quot;UNCAUGHT ERROR&quot;, err); };It's better to get one failed test and in test finalizers to close all descriptors, to stop proxies, to kill processes and so on, than to get fully failed tests queue in nightly build. That's why mechanism to suppress uncaught exceptions is enabled by default in GlaceJS. But it may be disabled with option --allow-uncaught. × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
